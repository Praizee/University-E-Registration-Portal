myApp.controller("applicantDashCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage){
    $scope.isAcceptanceFeeElapsed = false;

	$rootScope.content_loaded = true;
	$scope.bio_data = $localStorage.bio_data;
	$scope.setting = $localStorage.setting;

	$scope.active_unpaid_fee = {};
	$scope.has_active_unpaid_fee = false;

	$scope.fees = [
		
		{'fee_type': 'screening', 'name': 'Screening', 'status': 'unpaid'},
		{'fee_type': 'portal', 'name': 'Portal Access', 'status': 'unpaid'}
	];

	if($scope.bio_data.portal_payment_status == "paid"){
		$scope.fees[1].status = "paid";
	}

	if($scope.bio_data.screening_payment_status == "paid"){
		$scope.fees[0].status = "paid";
	}

	if($scope.fees[0].status == 'unpaid'){
		$scope.active_unpaid_fee = $scope.fees[0];
		$scope.has_active_unpaid_fee = true;
	}
	else if($scope.fees[1].status == 'unpaid'){
		$scope.active_unpaid_fee = $scope.fees[1];
		$scope.has_active_unpaid_fee = true;
	}
	else{
		$scope.active_unpaid_fee = {};
		$scope.has_active_unpaid_fee = false;
	}

	// alert(Object.keys($scope.active_unpaid_fee).length);

	// alert(JSON.stringify($scope.fees[0].fee_type));
	
	//alert(JSON.stringify($scope.bio_data));
	//$aggr = ($scope.bio_data.jambScore/8)+ ($scope.bio_data.score/2);
	//alert("Your Aggregate score is = "+$aggr);
	//alert($scope.bio_data.completionStatus);
	$scope.subjectCombinationStatus = $localStorage.subjectCombinationStatus;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	$scope.jambScore = $scope.bio_data.jambScore;
	$scope.completionStatus = $scope.bio_data.completionStatus;
	$scope.paymentStatus = $scope.bio_data.paymentStatus;
	$scope.canPayAcceptance = $scope.bio_data.canPayAcceptance;
	$scope.complaint_payment = $scope.bio_data.complaint_payment;
	//alert($scope.complaint_payment)
	$scope.paid = false;
	$scope.paid1 = false;
	$scope.cbt_paid = false;

    $scope.refusalToPay = function()
    {
        Data.toast({"status":"error", "message":"You cannot continue with payment since you did not agree with the payment terms"});
    }
	////////////// this is used to close the portal for payment
	$scope.payment_duration = 'off';
	//alert($scope.jambRegNo);
	//////////// this section is for those who have result review complaints
	$scope.ready_to_pay = false;
	$scope.change_ready_to_pay = function(){
	  $scope.ready_to_pay = true;
	}
	
	$scope.payment_begings = false;
	$http.post("backend/sqlprocesses.php?checkcomplaint=yes", {"jambRegNo": $scope.jambRegNo})
	.success(function(data) {
		// alert(data.message);
		$scope.complaint_status = data.message;
		// alert();
	})
	.error(function(data) {
		// $scope.hasError = "A network connection problem error occured while signing in. Please try again";
	});
    
	////////////// end of result review compaint

	////////////// enc of close the portal for payment
	
	// admitted candidates' place
	$scope.make_the_payment = false;
	$scope.go_ahead = function(){
	   $scope.make_the_payment = true;
	}

	$scope.admissionStatus = $scope.bio_data.admissionStatus;
	$scope.faculty = $scope.bio_data.facultyApplyingTo;
	$scope.department = $scope.bio_data.departmentApplyingTo;
	$scope.course = $scope.bio_data.course;
	$scope.acceptancefee = $scope.bio_data.acceptancefee;
	//alert("acceptance fee : "+ $scope.acceptancefee);
	// end of admitted candidates' place
	$scope.not_back = false;
	$scope.logout = function(){
		//alert('Hi');
		$rootScope.user_details = "";
		$rootScope.authenticated = false;
		$localStorage.$reset();
		$location.path("/");
	   
	}
	
	$scope.confirmation_made = false;
	$scope.evans_pay = false;
	$scope.requery_dv = false;
	
	$scope.requery = function(payment_name){
	    //alert(payment_name)
	    $scope.not_back = true;
	    $http.post("backend/sqlprocesses.php?requery=yes", {"jambRegNo": $scope.jambRegNo, "type" : payment_name})
		.success(function(data) {
		    $scope.not_back = false;
		    
			if(data.status === "successful"){
			   //alert("The transacstion was successful");
			   $scope.requery_dv = true;
				
			}
			if(data.status === "unsuccessful"){
			   //alert("The transacstion was successful");
			   Data.toast({"status":"error", "message":"None of your transactions was successfull"});
				
			}
		})
		.error(function(data) {
			$scope.hasError = "A network connection problem error occured while signing in. Please try again";
		});
		
	    
	}
	
	 $scope.uncheck_it = function () {
	    // alert();
	    $scope.evans_pay ="NO";
	}
	
	$scope.confirmed_it = function(){
	    //alert("confirmed_it");
	}
	
	
	$scope.applicantMode = $scope.bio_data.applicantMode;
	
	//alert($scope.bio_data.applicantMode);
	if($scope.jambScore < 200 && $scope.bio_data.applicantMode == "UTME"){
		$scope.eligiblity = false;
	}
	else{
		$scope.eligiblity = true;
		// if($scope.paymentStatus == "NULL" || $scope.paymentStatus == "unpaid" || $scope.paymentStatus === null){
		if($scope.bio_data.portal_payment_status == "unpaid" || $scope.bio_data.screening_payment_status == "unpaid"){
			//alert('unpaid');
			$scope.paid = false;
			$scope.bio_data_completion = false;

			$scope.defPayment_dv = true;
			$scope.enrollmentProceeduresDv = false;
		}
		// else if($scope.paymentStatus == "paid"){
		else if($scope.bio_data.portal_payment_status == "paid" && $scope.bio_data.screening_payment_status === "paid"){
	        //alert($scope.paymentStatus);
			$scope.paid = true;
			$scope.bio_data_completion = true;
			
			if($scope.bio_data.cbt_payment_status == "paid"){
			    $scope.cbt_paid = true;
			}
		}
		else{
		    
		}
		
		
		if($scope.acceptancefee == "NULL" || $scope.acceptancefee == "unpaid" || $scope.acceptancefee === null){
			//alert('unpaid');
			$scope.paid1 = false;
			$scope.defPayment_dv = true;
			$scope.enrollmentProceeduresDv = false;
		}
		else if($scope.acceptancefee == "paid"){
			$scope.paid1 = true;
			
		}
		else{
		    
		}
	}
	//alert("first payment" + $scope.paid);
	$rootScope.content_loaded = true;
	//alert($scope.eligiblity);
	
	$scope.simulatePayment = function () {
		$scope.defPayment_dv = false;
		$scope.enrollmentProceeduresDv = true;
		
		$scope.enrollmentInfo = true;
		$scope.privacyInfo = false;
	};
	
    $scope.displayPrivacyPolicyDV = function () {
		$scope.enrollmentInfo = false;
		$scope.privacyInfo = true;
	}
	
    $scope.displayCardEnrollmentDV = function () {
		$scope.enrollmentInfo = true;
		$scope.privacyInfo = false;
	}
	
    $scope.cancelPayment = function () {
		$scope.defPayment_dv = true;
		$scope.enrollmentProceeduresDv = false;
		
		$scope.enrollmentInfo = false;
		$scope.privacyInfo = false;
	}
	
	

	$scope.makePayment = function (jambRegNo, feeType, feeName) {
		 //alert(jambRegNo);
		// alert(feeType);
		 //alert(feeName);
		
		var serviceBase = 'backend/';
		//alert("Payment has closed!");
		window.location.replace("payment.php?action=pay&&jambRegNo="+jambRegNo+"&&feeType="+feeType+"&&feeName="+feeName);
		
		/*window.location.replace(serviceBase+"payment.php?action=pay&&jambRegNo="+jambRegNo);*/
		
		/*$http.get(serviceBase+"authentication.php?action=simulate_payment&&jambRegNo="+jambRegNo)
		.success(function(data) {
			if(data.status === "success"){
				$scope.bio_data.paymentStatus = "paid";
				$localStorage.bio_data = $scope.bio_data;
				$scope.applicantMode = $scope.bio_data.applicantMode
				
				if($scope.applicantMode === "utme" || $scope.applicantMode === "UTME"){
					$location.path("applicant/applicant-bio-data/"+$scope.jambRegNo);
				}
				else{
					$location.path("applicant/applicant-bio-data-de/"+$scope.jambRegNo); 
				}
			}
		})
		.error(function(data) {
			$scope.hasError = "A network connection problem error occured while signing in. Please try again";
		});*/
	};
	
	
	$http.post("backend/authentication.php?action=getHomeClearanceDetails&&jambRegNo="+$scope.jambRegNo)
	.success(function(data){
		$rootScope.content_loaded = false;
		
		if(data.status == "success"){
			$scope.clearanceDets = data.clearanceDets;
			
			if($scope.clearanceDets.length > 0){
				$scope.clearanceStage = $scope.clearanceDets.clearance_level;
				clearanceStatus = $scope.clearanceDets.status;
				$scope.clearanceDets.status = clearanceStatus.trim();
			}
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(errorMessage){
		$rootScope.content_loaded = true;
		Data.toast(data);
	});
	
});

myApp.controller("sampQuestionsCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage){
    //alert(JSON.stringify($localStorage.samp_q_downloads));
    $rootScope.content_loaded = true;
	$scope.samp_q_downloads = $localStorage.samp_q_downloads;
	$scope.bio_data = $localStorage.bio_data;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	
	$scope.download_subjects = 4 + $localStorage.additional_download_subjects;
	
	$scope.download_subjects = 4 + $localStorage.additional_download_subjects;

	
	
	$scope.serviceBase = 'backend/';
	//alert();
	$http.get($scope.serviceBase+"authentication.php?action=getSampleSubjects")
	.success(function(data) {
		if(data.status === "success"){
			samp_subjects = data.sample_subjects;
		
			$scope.samp_subjects = Array();
			
			for(var i = 0; i < samp_subjects.length; i++) {
				locked = checkSubjectLock($scope.samp_q_downloads, samp_subjects[i]['samp_qid']);
				
				$scope.samp_subjects[i] = {
								samp_qid: samp_subjects[i]['samp_qid'],
								subject: samp_subjects[i]['subject'],
								filename: samp_subjects[i]['filename'],
								display_download: true,
								locked: locked
							}
				
				if($scope.samp_q_downloads.length > ($scope.download_subjects - 1)){
					//alert($scope.samp_q_downloads.length);
					if(!$scope.samp_subjects[i]['locked']){
						$scope.samp_subjects[i]['display_download'] = false;
					}
				}
			}
			//alert(JSON.stringify($scope.samp_subjects));
		}
	})
	.error(function(data) {
		$scope.hasError = "A network connection problem error occured while signing in. Please try again";
	});
	
    $scope.downloadQuestions = function (subject) {
        //alert(JSON.stringify(subject));
		var samp_qid = subject['samp_qid'];
		var jambRegNo = $scope.jambRegNo;
		$scope.download_subjects = 4 + $localStorage.additional_download_subjects;
		//alert($scope.download_subjects);
		//alert(subject['samp_qid']);
		
		if($scope.samp_q_downloads.length < $scope.download_subjects){
			//alert($scope.serviceBase);
			$http.get($scope.serviceBase+"authentication.php?action=save_question_download&&jambRegNo="+jambRegNo+"&&samp_qid="+samp_qid)
			.success(function(data) {
				//alert(JSON.stringify(data));
				if(data.status === "success"){
					subject_exists = false;
					
					for(var k = 0; k < $scope.samp_q_downloads.length; k++) {
						if($scope.samp_q_downloads[k]['samp_qid'] === subject['samp_qid']){
							if(data.status === "success"){
								no_of_downloads = $scope.samp_q_downloads[k]['no_of_downloads'];
								$scope.samp_q_downloads[k]['no_of_downloads'] = no_of_downloads + 1;
							}
							
							subject_exists = true;
							break;
						}
					}
					
					if(!subject_exists){
						i = $scope.samp_q_downloads.length;
				
						$scope.samp_q_downloads[i] = {
											samp_qid: subject['samp_qid'],
											no_of_downloads: 1
										}
						
						for(var j = 0; j < $scope.samp_subjects.length; j++) {
							if($scope.samp_subjects[j]['samp_qid'] === subject['samp_qid']){
								$scope.samp_subjects[j]['locked'] = true;
								//break;
							}
							
							//if($scope.samp_q_downloads.length > 3){
							if($scope.samp_q_downloads.length > ($scope.download_subjects - 1)){
								//alert($scope.samp_q_downloads.length);
								if(!$scope.samp_subjects[j]['locked']){
									$scope.samp_subjects[j]['display_download'] = false;
								}
							}
						}
					}
				}
				
				window.open('backend/saveAs.php?file_source='+ subject.filename, '_self', '');
			})
			.error(function(data) {
				$scope.hasError = "A network connection problem error occured while signing in. Please try again";
			});
			
		}
		else{
			for(var k = 0; k < $scope.samp_q_downloads.length; k++) {
				if($scope.samp_q_downloads[k]['samp_qid'] === subject['samp_qid']){
					$http.get($scope.serviceBase+"authentication.php?action=save_question_download&&jambRegNo="+jambRegNo+"&& samp_qid="+samp_qid)
					.success(function(data) {
						if(data.status === "success"){
							no_of_downloads = $scope.samp_q_downloads[k]['no_of_downloads'];
							$scope.samp_q_downloads[k]['no_of_downloads'] = no_of_downloads + 1;
							
							//alert($scope.samp_q_downloads[k]['no_of_downloads']);
							window.open('backend/saveAs.php?file_source='+ subject.filename, '_self', '');
						}
					})
					.error(function(data) {
						$scope.hasError = "A network connection problem error occured while signing in. Please try again";
					});
					
					break;
				}
			}
		}
		//alert(JSON.stringify($scope.samp_q_downloads));
		//var serviceBase = 'backend/';
		
		/**/
	};
	/**/
});

function checkSubjectLock(samp_q_downloads, samp_qid){
	locked = false;
	
	for(var i = 0; i < samp_q_downloads.length; i++) {
		if(samp_q_downloads[i]['samp_qid'] === samp_qid){
			locked = true;
			break;
		}
	}
	
	return locked
}

myApp.controller("paymentSuccessCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = false;
	
	$scope.orderId = $routeParams['orderId'];
	serviceBase = "backend/";
	
	//$rootScope.jambRegNo = $scope.jambRegNo;

	$scope.paymentTypeDets = {
		'type': '',
		'name': '',
		'amount': '',
		'desc': ''
	};

	$http.get(serviceBase+"admin.php?action=get_order_applicant_data&&orderId="+$scope.orderId)
	.success(function(data) {
		if(data.status === "success"){
			// alert(JSON.stringify(data.order_info));

			bio_data = data.applicant_data;
			orderInfo = data.order_info;
			
			$rootScope.bio_data = bio_data;
			$localStorage.bio_data = bio_data;
			
			$scope.orderInfo = orderInfo;

			if($scope.orderInfo.feeType == 'portal'){
				$scope.paymentTypeDets.name = 'Portal Access Fee';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = 'Portal Access Fee';
			}
			else if($scope.orderInfo.feeType == 'screening'){
				// alert('Screening Fee');
				$scope.paymentTypeDets.name = 'Screening Fee';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = 'Screening Fee';
			}
			else{
				$scope.paymentTypeDets.name = '';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = '';
			}
			
			// if($rootScope.bio_data.paymentStatus === "paid"){
				$scope.payment_success = true;
			// }
			// else{
			// 	$location.path("applicant/applicant-dashboard/");
			// }
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(data) {
		message_code = {status: 'error', message: 'A network connection problem error occured while connecting. Please try again'};
		
		$rootScope.content_loaded = true;
		//Data.toast(message_code);
	});
	
});


myApp.controller("paymentSuccessAcceptanceCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = false;
	
	$scope.orderId = $routeParams['orderId'];	
	serviceBase = "backend/";
	
	//$rootScope.jambRegNo = $scope.jambRegNo;

	$http.get(serviceBase+"admin.php?action=get_order_applicant_data&&orderId="+$scope.orderId)
	.success(function(data) {
		if(data.status === "success"){
			bio_data = data.applicant_data;
			orderInfo = data.order_info;
			
			$rootScope.bio_data = bio_data;
			$localStorage.bio_data = bio_data;
			
			$scope.orderInfo = orderInfo;
			
			if($rootScope.bio_data.acceptancefee === "paid"){
				$scope.payment_success = true;
			}
			else{
				$location.path("applicant/applicant-dashboard/");
			}
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(data) {
		message_code = {status: 'error', message: 'A network connection problem error occured while connecting. Please try again'};
		
		$rootScope.content_loaded = true;
		//Data.toast(message_code);
	});
	
});


myApp.controller("paymentErrorCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = false;
	
	$scope.errorCde = $routeParams['errorCde'];	
	serviceBase = "backend/";
	
	$scope.networkErr = false;
	$scope.updateApplErr = false;
	$scope.updateOrdrErr = false;
	$scope.paymentErr = false;

	$scope.paymentTypeDets = {
		'type': '',
		'name': '',
		'amount': '',
		'desc': ''
	};
	
	if($scope.errorCde === "network-connection"){
		$scope.networkErr = true;
		$rootScope.content_loaded = true;
	}
	else if($scope.errorCde === "update-applicant-error"){
		$scope.updateApplErr = true;
		$rootScope.content_loaded = true;
	}
	else if($scope.errorCde === "update-order-error"){
		$scope.updateOrdrErr = true;
		$rootScope.content_loaded = true;
	}
	else{
		$scope.orderId = $scope.errorCde;
		$scope.paymentErr = true;
		
		$http.get(serviceBase+"admin.php?action=get_order_applicant_data&&orderId="+$scope.orderId)
		.success(function(data) {
			if(data.status === "success"){
				bio_data = data.applicant_data;
				orderInfo = data.order_info;
				
				$rootScope.bio_data = bio_data;
				$localStorage.bio_data = bio_data;
				
				$scope.orderInfo = orderInfo;
				if($scope.orderInfo.pan === ""){
					$scope.orderInfo.pan = "--Nil--";
				}
				//alert(json.stringify($scope.orderInfo));

				if($scope.orderInfo.feeType == 'portal'){
					$scope.paymentTypeDets.name = 'Portal Access Fee';
					$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
					$scope.paymentTypeDets.amount = '2,000.00';
					$scope.paymentTypeDets.desc = 'Portal Access Fee';
				}
				else if($scope.orderInfo.feeType == 'screening'){
					// alert('Screening Fee');
					$scope.paymentTypeDets.name = 'Screening Fee';
					$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
					$scope.paymentTypeDets.amount = '2,000.00';
					$scope.paymentTypeDets.desc = 'Screening Fee';
				}
				else{
					$scope.paymentTypeDets.name = '';
					$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
					$scope.paymentTypeDets.amount = '2,000.00';
					$scope.paymentTypeDets.desc = '';
				}
				
				// alert($scope.paymentTypeDets.name);
				
				if($rootScope.bio_data.paymentStatus === "paid"){
					//$scope.payment_success = true;
				}
				else{
					//$location.path("applicant/applicant-dashboard/");
				}
				
				$rootScope.content_loaded = true;
			}
			
			$rootScope.content_loaded = true;	})
		.error(function(data) {
			message_code = {status: 'error', message: 'A network connection problem error occured while connecting. Please try again'};
			
			$rootScope.content_loaded = true;
			//Data.toast(message_code);
		});
	}
	
	//$rootScope.content_loaded = true;
		
});

// reprint receipt stuff
myApp.controller("reprintReceiptCtrl1", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = false;
	$scope.feeType = $routeParams['feeType'];
	
	$scope.bio_data = $localStorage.bio_data;	
	$scope.jambRegNo = $scope.bio_data.jambRegNo;	
	
	$scope.receiptAvailability = false;
	
	$scope.paymentTypeDets = {
		'type': '',
		'name': '',
		'amount': '',
		'desc': ''
	};

	$http.post("backend/admin.php?action=get_reprint_order_applicant_data&&jambRegNo="+$scope.jambRegNo+"&&feeType="+$scope.feeType)
	.success(function(response) {
	    
	   if(response.status === "success"){
			bio_data = response.applicant_data;
			orderInfo = response.order_info;
			//alert(JSON.stringify(orderInfo));
			$scope.bio_data = bio_data;
			//$localStorage.bio_data = bio_data;
			
			$scope.orderInfo = orderInfo;
			$scope.receiptAvailability = true;
			
			if($scope.orderInfo.feeType == 'portal'){
				$scope.paymentTypeDets.name = 'Portal Access Fee';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = 'Portal Access Fee';
			}
			else if($scope.orderInfo.feeType == 'screening'){
				// alert('Screening Fee');
				$scope.paymentTypeDets.name = 'Screening Fee';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = 'Screening Fee';
			}
			else{
				$scope.paymentTypeDets.name = '';
				$scope.paymentTypeDets.type = $scope.orderInfo.feeType;
				$scope.paymentTypeDets.amount = '2,000.00';
				$scope.paymentTypeDets.desc = '';
			}
			
			//alert(bio_data.acceptanceFee);
			//if(bio_data.paymentStatus === "paid"){
			
			//if(bio_data.paymentStatus === "paid"){
// 			if($scope.bio_data.cbt_payment_status == "paid"){
			// if($scope.bio_data.acceptancefee == "paid"){
				$scope.payment_success = true;
			// }
			// else{
			// 	$location.path("applicant/applicant-dashboard/");
			// }
		}
		else{
            $scope.receiptAvailability = false;
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(data) {
		message_code = {status: 'error', message: 'A network connection problem error occured while connecting. Please try again'};
		
		$rootScope.content_loaded = true;
	});
	
});

myApp.controller("reprintScreeningReceiptCtrl1", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = false;
	
	$scope.bio_data = $localStorage.bio_data;	
	$scope.jambRegNo = $scope.bio_data.jambRegNo;	
	$scope.receiptAvailability = false;
	$http.post("backend/admin.php?action=get_reprint_order_screening_applicant_data&&jambRegNo="+$scope.jambRegNo)
	.success(function(response) {
	    //alert(JSON.stringify(response));
	   if(response.status === "success"){
			bio_data = response.applicant_data;
			orderInfo = response.order_info;
			
			$scope.bio_data = bio_data;
			$scope.receiptAvailability = true;
			//$localStorage.bio_data = bio_data;
			
			$scope.orderInfo = orderInfo;
			
			//alert(bio_data.acceptanceFee);
			if(bio_data.paymentStatus === "paid"){
				$scope.payment_success = true;
			}
			else{
				$location.path("applicant/applicant-dashboard/");
			}
		}
		else{
				$scope.receiptAvailability = false;
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(data) {
		message_code = {status: 'error', message: 'A network connection problem error occured while connecting. Please try again'};
		
		$rootScope.content_loaded = true;
	});
	
});

// clearance documents
myApp.controller("clearanceCtrl1", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = true;
	$scope.bio_data = $localStorage.bio_data;
	$scope.subjectCombinationStatus = $localStorage.subjectCombinationStatus;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	
	$scope.accept = false;
	

	
	
});


// clearance documents
myApp.controller("acceptanceCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage, $modal){
	$rootScope.content_loaded = true;
	$scope.bio_data = $localStorage.bio_data;
	$scope.subjectCombinationStatus = $localStorage.subjectCombinationStatus;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	$scope.filename = "signature/"+$scope.jambRegNo +".jpg";
	
	
	

	
	
});




myApp.controller("printMedicalCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage){
	$rootScope.content_loaded = true;
	$scope.bio_data = $localStorage.bio_data;
	$scope.subjectCombinationStatus = $localStorage.subjectCombinationStatus;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	$scope.applicantJambNo = {"jambNumber": $scope.jambRegNo}; 
	
	
	$scope.greetings = "Dear";

//$scope.dateArray = new Date();
$scope.showPrint =true;
$scope.admissionOfficer = "Mrs Afolabi ...";
$scope.today ="2016-11-25";
$http.post("backend/sqlprocessesmed.php?getApplicantMedical=yes", $scope.applicantJambNo)
		.success(function(response){
			//alert(JSON.stringify(response));
			if(response.status == "ok")
			{
				$scope.applicant = response.data;
				$scope.medical = response.data1;
				$scope.photo = $scope.applicant.jambRegNo + ".jpg";
				$scope.photo2 = $scope.applicant.jambRegNo + ".JPG";
				$scope.applicant.surname= $scope.applicant.surname.toUpperCase();
				$scope.applicant.middlename=  $scope.applicant.middlename.charAt(0).toUpperCase() + $scope.applicant.middlename.substr(1).toLowerCase()
				$scope.applicant.firstname =  $scope.applicant.firstname.charAt(0).toUpperCase() + $scope.applicant.firstname.substr(1).toLowerCase()
			}
			else if(response.status == "not ok")	
			{
				$scope.message = "Unable to retrieve applicant";
				var modalInstance = $modal.open(
					{
					 templateUrl: 'partials/alerts.html',
					  controller: 'alertCtrl',
					  keyboard : false,
					  size:"sm",
					  resolve: {
								items: function () {
								  return items;
								}
					  }
					  
					});
					
					$rootScope.content_loaded = true;
			}
			else
			{
			
			}
		})
		.error(function(errorMessage){

	$rootScope.content_loaded = true;
		});	
	
$scope.printDiv = function(divName)
{
	$scope.showPrint = false;
	printIt(divName);
	
}


function printIt(divName) {

    printContents = document.getElementById(divName).innerHTML;
	//alert(printContents);
     var originalContents = document.body.innerHTML;
     document.body.innerHTML = printContents;

     window.print();
     document.body.innerHTML = originalContents;
}
	
	
});

myApp.controller("medicalCtrl", function($rootScope, $scope, $routeParams, $location, $http, Data, $localStorage){
	$rootScope.content_loaded = false;
	$scope.bio_data = $localStorage.bio_data;
	$scope.subjectCombinationStatus = $localStorage.subjectCombinationStatus;
	$scope.jambRegNo = $scope.bio_data.jambRegNo;
	
	
	$scope.dataIsNotReady = true;
	$scope.applicantJambNo = {"jambNumber": $scope.jambRegNo}; 
	
	$scope.applicant= {'completionStatus':'incompleted'};
	$scope.buttonParts = [false,false,false,false,false,false,false,false];
	
	//get applicant information
	//alert($scope.applicantJambNo.jambNumber);
	$http.post("backend/sqlprocessesmed.php?getApplicantMedical=yes", $scope.applicantJambNo)
		.success(function(response){
			$rootScope.content_loaded = true;
			if(response.status == "ok")
			{
				$scope.applicant = response.data;
				if(response.status1 == "ok")
				{
					$scope.medical1 = response.data1;
					$scope.showpart = $scope.medical1.completionStatus
					for(i=0; i<$scope.showpart-1; i++)
					{
						$scope.buttonParts[i]= true;
					}


					if($scope.showpart==1)
					{
						$scope.medical = {
										'inpatient':"[ Select An Option ]",
										'surgery':"[ Select An Option ]",
										'anyMedication':"[ Select An Option ]",
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':"[ Select An Option ]",
										'asthma':"[ Select An Option ]",
										'pepticUlcer':"[ Select An Option ]",
										'sickleCell':"[ Select An Option ]",
										'allergies':"[ Select An Option ]",
										'diabetes':"[ Select An Option ]",
										'hypertension':"[ Select An Option ]",
										'siezure':"[ Select An Option ]",
										'mentalIllness':"[ Select An Option ]",
										'familyTB':"[ Select An Option ]",
										'familyHypertension':"[ Select An Option ]",
										'familySeizure':"[ Select An Option ]",
										'familyDiabetes':"[ Select An Option ]",
										'familyMentalSickness':"[ Select An Option ]",
										'drugReaction':"[ Select An Option ]",
										'immunizedHepatitisB':"[ Select An Option ]",
										'immunizedYellowFever':"[ Select An Option ]",
										'immunizedTetanus':"[ Select An Option ]",
										'immunizedCSM':"[ Select An Option ]",
										'smokeOrSnuff':"[ Select An Option ]",
										'neighbourSmoker':"[ Select An Option ]",
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':"[ Select An Option ]",
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':"Reason for admission",
										'surgeryReason':"",
										'drugAndDose':"",
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':"",
										'otherImmunization':"",
										'smokingQuantity':"",
										'durationOfSmoking':"",
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':"",
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':"Details of the sickness(es) you have suffered",
										'immunizedHepatitisBDate':"",
										'immunizedYellowFeverDate':"",
										'immunizedCSMDate':"",
										'immunizedTetanusDate':"",
										'startingYearOfSmoking':""
										};
		
							$scope.dataIsNotReady = false;
							}
							else if($scope.showpart==2)
							{
								/*assign the returned data to medical2 and pass the attributes of the object that have been filled to medical and the remaining attributes are still initialised to the case in showpart=1 */
									$scope.medical2 = response.data1;
									
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':"[ Select An Option ]",
										'asthma':"[ Select An Option ]",
										'pepticUlcer':"[ Select An Option ]",
										'sickleCell':"[ Select An Option ]",
										'allergies':"[ Select An Option ]",
										'diabetes':"[ Select An Option ]",
										'hypertension':"[ Select An Option ]",
										'siezure':"[ Select An Option ]",
										'mentalIllness':"[ Select An Option ]",
										'familyTB':"[ Select An Option ]",
										'familyHypertension':"[ Select An Option ]",
										'familySeizure':"[ Select An Option ]",
										'familyDiabetes':"[ Select An Option ]",
										'familyMentalSickness':"[ Select An Option ]",
										'drugReaction':"[ Select An Option ]",
										'immunizedHepatitisB':"[ Select An Option ]",
										'immunizedYellowFever':"[ Select An Option ]",
										'immunizedTetanus':"[ Select An Option ]",
										'immunizedCSM':"[ Select An Option ]",
										'smokeOrSnuff':"[ Select An Option ]",
										'neighbourSmoker':"[ Select An Option ]",
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':"[ Select An Option ]",
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':"",
										'otherImmunization':"",
										'smokingQuantity':"",
										'durationOfSmoking':"",
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':"",
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':"Details of the sickness(es) you have suffered",
										'immunizedHepatitisBDate':"",
										'immunizedYellowFeverDate':"",
										'immunizedCSMDate':"",
										'immunizedTetanusDate':"",
										'startingYearOfSmoking':""
										};
										$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==3)
							{
								/*assign the returned data to medical2 and pass the attributes of the object medical2 that have been filled to medical and the remaining attributes are still initialised to the case in showpart=1 */
									$scope.medical2 = response.data1;
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':"[ Select An Option ]",
										'mentalIllness':"[ Select An Option ]",
										'familyTB':"[ Select An Option ]",
										'familyHypertension':"[ Select An Option ]",
										'familySeizure':"[ Select An Option ]",
										'familyDiabetes':"[ Select An Option ]",
										'familyMentalSickness':"[ Select An Option ]",
										'drugReaction':"[ Select An Option ]",
										'immunizedHepatitisB':"[ Select An Option ]",
										'immunizedYellowFever':"[ Select An Option ]",
										'immunizedTetanus':"[ Select An Option ]",
										'immunizedCSM':"[ Select An Option ]",
										'smokeOrSnuff':"[ Select An Option ]",
										'neighbourSmoker':"[ Select An Option ]",
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':"[ Select An Option ]",
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':"",
										'otherImmunization':"",
										'smokingQuantity':"",
										'durationOfSmoking':"",
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':"",
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':"Details of the sickness(es) you have suffered",
										'immunizedHepatitisBDate':"",
										'immunizedYellowFeverDate':"",
										'immunizedCSMDate':"",
										'immunizedTetanusDate':"",
										'startingYearOfSmoking':""
										};
									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==4)
							{
									$scope.medical2 = response.data1;
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':$scope.medical2.siezure,
										'mentalIllness':$scope.medical2.mentalIllness,
										'familyTB':$scope.medical2.familyTB,
										'familyHypertension':$scope.medical2.familyHypertension,
										'familySeizure':$scope.medical2.familySeizure,
										'familyDiabetes':"[ Select An Option ]",
										'familyMentalSickness':"[ Select An Option ]",
										'drugReaction':"[ Select An Option ]",
										'immunizedHepatitisB':"[ Select An Option ]",
										'immunizedYellowFever':"[ Select An Option ]",
										'immunizedTetanus':"[ Select An Option ]",
										'immunizedCSM':"[ Select An Option ]",
										'smokeOrSnuff':"[ Select An Option ]",
										'neighbourSmoker':"[ Select An Option ]",
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':$scope.medical2.otherailment,
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':"",
										'otherImmunization':"",
										'smokingQuantity':"",
										'durationOfSmoking':"",
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':$scope.medical2.otherSicknesses,
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':$scope.medical2.detailOfOtherSicknesses,
										'immunizedHepatitisBDate':"",
										'immunizedYellowFeverDate':"",
										'immunizedCSMDate':"",
										'immunizedTetanusDate':"",
										'startingYearOfSmoking':""
										};

									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==5)
							{
									$scope.medical2 = response.data1;
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':$scope.medical2.siezure,
										'mentalIllness':$scope.medical2.mentalIllness,
										'familyTB':$scope.medical2.familyTB,
										'familyHypertension':$scope.medical2.familyHypertension,
										'familySeizure':$scope.medical2.familySeizure,
										'familyDiabetes':$scope.medical2.familyDiabetes,
										'familyMentalSickness':$scope.medical2.familyMentalSickness,
										'drugReaction':$scope.medical2.drugReaction,
										'immunizedHepatitisB':$scope.medical2.immunizedHepatitisB,
										'immunizedYellowFever':$scope.medical2.immunizedYellowFever,
										'immunizedTetanus':"[ Select An Option ]",
										'immunizedCSM':"[ Select An Option ]",
										'smokeOrSnuff':"[ Select An Option ]",
										'neighbourSmoker':"[ Select An Option ]",
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':$scope.medical2.otherailment,
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':$scope.medical2.reactingDrug,
										'otherImmunization':"",
										'smokingQuantity':"",
										'durationOfSmoking':"",
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':$scope.medical2.otherSicknesses,
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':$scope.medical2.detailOfOtherSicknesses,
										'immunizedHepatitisBDate':$scope.medical2.immunizedHepatitisBDate,
										'immunizedYellowFeverDate':$scope.medical2.immunizedYellowFeverDate,
										'immunizedCSMDate':"",
										'immunizedTetanusDate':"",
										'startingYearOfSmoking':""
										};

									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==6)
							{
									$scope.medical2 = response.data1;
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':$scope.medical2.siezure,
										'mentalIllness':$scope.medical2.mentalIllness,
										'familyTB':$scope.medical2.familyTB,
										'familyHypertension':$scope.medical2.familyHypertension,
										'familySeizure':$scope.medical2.familySeizure,
										'familyDiabetes':$scope.medical2.familyDiabetes,
										'familyMentalSickness':$scope.medical2.familyMentalSickness,
										'drugReaction':$scope.medical2.drugReaction,
										'immunizedHepatitisB':$scope.medical2.immunizedHepatitisB,
										'immunizedYellowFever':$scope.medical2.immunizedYellowFever,
										'immunizedTetanus':$scope.medical2.immunizedTetanus,
										'immunizedCSM':$scope.medical2.immunizedCSM,
										'smokeOrSnuff':$scope.medical2.smokeOrSnuff,
										'neighbourSmoker':$scope.medical2.neighbourSmoker,
										'drinkAlcoholAtPresent':"[ Select An Option ]",
										'alcoholFrequency':"[ Select An Option ]",
										'drinkAlcoholInAnyForm':"[ Select An Option ]",
										'exercise':"[ Select An Option ]",
										'howOftenExercise':"[ Select An Option ]",
										'eatFruit':"[ Select An Option ]",
										'otherailment':$scope.medical2.otherailment,
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':$scope.medical2.reactingDrug,
										'otherImmunization':$scope.medical2.otherImmunization,
										'smokingQuantity':$scope.medical2.smokingQuantity,
										'durationOfSmoking':$scope.medical2.durationOfSmoking,
										'alcoholQuantity':"",
										'nameOfexercise':"",
										'exerciseDuration':"",
										'otherSicknesses':$scope.medical2.otherSicknesses,
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':$scope.medical2.detailOfOtherSicknesses,
										'immunizedHepatitisBDate':$scope.medical2.immunizedHepatitisBDate,
										'immunizedYellowFeverDate':$scope.medical2.immunizedYellowFeverDate,
										'immunizedCSMDate':$scope.medical2.immunizedCSMDate,
										'immunizedTetanusDate':$scope.medical2.immunizedTetanusDate,
										'startingYearOfSmoking':$scope.medical2.startingYearOfSmoking
										};
									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==7)
							{ 
									$scope.medical2 = response.data1;
									$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':$scope.medical2.siezure,
										'mentalIllness':$scope.medical2.mentalIllness,
										'familyTB':$scope.medical2.familyTB,
										'familyHypertension':$scope.medical2.familyHypertension,
										'familySeizure':$scope.medical2.familySeizure,
										'familyDiabetes':$scope.medical2.familyDiabetes,
										'familyMentalSickness':$scope.medical2.familyMentalSickness,
										'drugReaction':$scope.medical2.drugReaction,
										'immunizedHepatitisB':$scope.medical2.immunizedHepatitisB,
										'immunizedYellowFever':$scope.medical2.immunizedYellowFever,
										'immunizedTetanus':$scope.medical2.immunizedTetanus,
										'immunizedCSM':$scope.medical2.immunizedCSM,
										'smokeOrSnuff':$scope.medical2.smokeOrSnuff,
										'neighbourSmoker':$scope.medical2.neighbourSmoker,
										'drinkAlcoholAtPresent':$scope.medical2.drinkAlcoholAtPresent,
										'alcoholFrequency':$scope.medical2.alcoholFrequency,
										'drinkAlcoholInAnyForm':$scope.medical2.drinkAlcoholInAnyForm,
										'exercise':$scope.medical2.exercise,
										'howOftenExercise':$scope.medical2.howOftenExercise,
										'eatFruit':"[ Select An Option ]",
										'otherailment':$scope.medical2.otherailment,
										'eatUncookedVegetable':"[ Select An Option ]",
										'eatCookedVegetable':"[ Select An Option ]",
										'eatPastries':"[ Select An Option ]",
										'eatFried':"[ Select An Option ]",
										'softDrink':"[ Select An Option ]",
										'eatRedMeat':"[ Select An Option ]",
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':$scope.medical2.reactingDrug,
										'otherImmunization':$scope.medical2.otherImmunization,
										'smokingQuantity':$scope.medical2.smokingQuantity,
										'durationOfSmoking':$scope.medical2.durationOfSmoking,
										'alcoholQuantity':$scope.medical2.alcoholQuantity,
										'alcoholStartingAge':$scope.medical2.alcoholStartingAge,
										'nameOfexercise':$scope.medical2.nameOfexercise,
										'exerciseDuration':$scope.medical2.exerciseDuration,
										'otherSicknesses':$scope.medical2.otherSicknesses,
										'eatFruitQuantity':"",
										'eatUncookedVegetableQuantity':"",
										'eatCookedVegetableQuantity':"",
										'eatPastriesQuantity':"",
										'eatFriedQuantity':"",
										'softDrinkQuantity':"",
										'eatRedMeatQuantity':"",
										'detailOfOtherSicknesses':$scope.medical2.detailOfOtherSicknesses,
										'immunizedHepatitisBDate':$scope.medical2.immunizedHepatitisBDate,
										'immunizedYellowFeverDate':$scope.medical2.immunizedYellowFeverDate,
										'immunizedCSMDate':$scope.medical2.immunizedCSMDate,
										'immunizedTetanusDate':$scope.medical2.immunizedTetanusDate,
										'startingYearOfSmoking':$scope.medical2.startingYearOfSmoking
										};
									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==8)
							{
									$scope.medical2 = response.data1;
																		$scope.medical = {
										'inpatient':$scope.medical2.inpatient,
										'surgery':$scope.medical2.surgery,
										'anyMedication':$scope.medical2.anyMedication,
										'knowGenotype':"[ Select An Option ]",
										'tuberculosis':$scope.medical2.tuberculosis,
										'asthma':$scope.medical2.asthma,
										'pepticUlcer':$scope.medical2.pepticUlcer,
										'sickleCell':$scope.medical2.sickleCell,
										'allergies':$scope.medical2.allergies,
										'diabetes':$scope.medical2.diabetes,
										'hypertension':$scope.medical2.hypertension,
										'siezure':$scope.medical2.siezure,
										'mentalIllness':$scope.medical2.mentalIllness,
										'familyTB':$scope.medical2.familyTB,
										'familyHypertension':$scope.medical2.familyHypertension,
										'familySeizure':$scope.medical2.familySeizure,
										'familyDiabetes':$scope.medical2.familyDiabetes,
										'familyMentalSickness':$scope.medical2.familyMentalSickness,
										'drugReaction':$scope.medical2.drugReaction,
										'immunizedHepatitisB':$scope.medical2.immunizedHepatitisB,
										'immunizedYellowFever':$scope.medical2.immunizedYellowFever,
										'immunizedTetanus':$scope.medical2.immunizedTetanus,
										'immunizedCSM':$scope.medical2.immunizedCSM,
										'smokeOrSnuff':$scope.medical2.smokeOrSnuff,
										'neighbourSmoker':$scope.medical2.neighbourSmoker,
										'drinkAlcoholAtPresent':$scope.medical2.drinkAlcoholAtPresent,
										'alcoholFrequency':$scope.medical2.alcoholFrequency,
										'drinkAlcoholInAnyForm':$scope.medical2.drinkAlcoholInAnyForm,
										'exercise':$scope.medical2.exercise,
										'howOftenExercise':$scope.medical2.howOftenExercise,
										
										'eatFruit':$scope.medical2.eatFruit,
										'otherailment':$scope.medical2.otherailment,
										'eatUncookedVegetable':$scope.medical2.eatUncookedVegetable,
										'eatCookedVegetable':$scope.medical2.eatCookedVegetable,
										'eatPastries':$scope.medical2.eatPastries,
										'eatFried':$scope.medical2.eatFried,
										'softDrink':$scope.medical2.softDrink,
										'eatRedMeat':$scope.medical2.eatRedMeat,
										'knowBloodGroup':"[ Select An Option ]",
										'inpatientReason':$scope.medical2.inpatientReason,
										'surgeryReason':$scope.medical2.surgeryReason,
										'drugAndDose':$scope.medical2.drugAndDose,
										'genotype':"",
										'bloodGroup':"",
										'detailsOfMedNotcovered':"Details of medical information not covered",
										'reactingDrug':$scope.medical2.reactingDrug,
										'otherImmunization':$scope.medical2.otherImmunization,
										'smokingQuantity':$scope.medical2.smokingQuantity,
										'durationOfSmoking':$scope.medical2.durationOfSmoking,
										'alcoholQuantity':$scope.medical2.alcoholQuantity,
										'alcoholStartingAge':$scope.medical2.alcoholStartingAge,
										'nameOfexercise':$scope.medical2.nameOfexercise,
										'exerciseDuration':$scope.medical2.exerciseDuration,
										'otherSicknesses':$scope.medical2.otherSicknesses,
										'eatFruitQuantity':$scope.medical2.eatFruitQuantity,
										'eatUncookedVegetableQuantity':$scope.medical2.eatUncookedVegetableQuantity,
										'eatCookedVegetableQuantity':$scope.medical2.eatCookedVegetableQuantity,
										'eatPastriesQuantity':$scope.medical2.eatPastriesQuantity,
										'eatFriedQuantity':$scope.medical2.eatFriedQuantity,
										'softDrinkQuantity':$scope.medical2.softDrinkQuantity,
										'eatRedMeatQuantity':$scope.medical2.eatRedMeatQuantity,
										'detailOfOtherSicknesses':$scope.medical2.detailOfOtherSicknesses,
										'immunizedHepatitisBDate':$scope.medical2.immunizedHepatitisBDate,
										'immunizedYellowFeverDate':$scope.medical2.immunizedYellowFeverDate,
										'immunizedCSMDate':$scope.medical2.immunizedCSMDate,
										'immunizedTetanusDate':$scope.medical2.immunizedTetanusDate,
										'startingYearOfSmoking':$scope.medical2.startingYearOfSmoking
										};

									$scope.dataIsNotReady = false;
									
							}
							else if($scope.showpart==9)
							{
									$scope.medical = response.data1;
									$scope.dataIsNotReady = false;
									
							}
						
						
						
						
						
						
						
						
					
				}
			}
			else if(response.status == "not ok")	
			{
				items = "Unable to retrieve applicant";
				modalMessage(items);
				
			}
			else 
			{
			
			}
			
			/*$rootScope.content_loaded = true;*/
		})
		.error(function(errorMessage){
			/*$rootScope.content_loaded = true;*/
		});
	
	
	
	//get applicant
	
	
	// end of get applicant
	
	
	// disabl all the navigation buttons
	/*$scope.partone = false;
	$scope.parttwo = false;
	$scope.partthree = false;
	$scope.partfour = false;
	$scope.partfive = false;
	$scope.partsix = false;
	$scope.partseven = false;
	$scope.parteight = false;
	*/
	
	// showing and hiding of the various panels
	/*$scope.showpartone = true;
	$scope.showparttwo = false;
	$scope.showpartthree = false;
	$scope.partfour = false;
	$scope.showpartfive = false;
	$scope.showpartsix = false;
	$scope.showpartseven = false;
	$scope.showparteight = false;
	*/
	
	$scope.part1 = function()
	{
		$scope.showpart = 1
	}
	
	$scope.part2 = function()
	{
	
		$scope.showpart = 2
	}	
	
	$scope.part3 = function()
	{
		$scope.showpart = 3
	}	
	
	$scope.part4 = function()
	{
		$scope.showpart = 4
	}	
	
	$scope.part5 = function()
	{
		$scope.showpart = 5
	}	
	
	$scope.part6 = function()
	{
		$scope.showpart = 6
	}	
	
	$scope.part7 = function()
	{
		$scope.showpart = 7
	}	
	
	$scope.part8 = function()
	{
		$scope.showpart = 8
	}	
	
		
	// the options array
	$scope.options = ['[ Select An Option ]','Yes', 'No'];
	
	
	
	
	// medical object
	
	
$scope.immunizationStuff = "[ Select An Option ]";


// on change funtions for all the conditional initialization of the textareas
		
$scope.changeInpatient = function()
{
	$scope.medical.inpatient =='Yes'? $scope.medical.inpatientReason = "Reason for admission": $scope.medical.inpatientReason = "";

}

$scope.changeOtherailment = function()
{
	$scope.medical.otherailment =='Yes'? $scope.medical.otherSicknesses = "Name of ailment(s)": $scope.medical.otherSicknesses = "";

}

$scope.changeDrinkAlcoholAtPresent = function()
{
	$scope.medical.drinkAlcoholAtPresent =='No'? $scope.medical.alcoholFrequency = "": $scope.medical.alcoholFrequency = "[ Select An Option ]";
	$scope.medical.drinkAlcoholAtPresent =='Yes'? $scope.medical.drinkAlcoholInAnyForm = "": $scope.medical.drinkAlcoholInAnyForm = "[ Select An Option ]";

}



$scope.didSurgery = function()
{
	$scope.medical.surgery =='Yes'? $scope.medical.surgeryReason = "State where it was done and the year": $scope.medical.surgeryReason = "";
}

$scope.didMedication = function()
{
	$scope.medical.anyMedication =='Yes'? $scope.medical.drugAndDose = "State the drug and the dose": $scope.medical.drugAndDose = "";
	$scope.medical.anyMedication =='Yes'||$scope.medical.anyMedication =='No'? $scope.isReady = true : $scope.isReady = false ;
}

$scope.anyDrugReaction = function()
{
	$scope.medical.drugReaction =='Yes'? $scope.medical.reactingDrug = "State name(s) of drug": $scope.medical.reactingDrug = "";
}

$scope.changeAnyOtherImmunization = function()
{
	$scope.immunizationStuff =='Yes'? $scope.medical.otherImmunization = "State the immunizations(s) and the date(s)": $scope.medical.otherImmunization = "";
}


$scope.changeSmokeOrSnuff = function()
{
	$scope.medical.smokeOrSnuff =='Yes'? $scope.medical.smokingQuantity = "Specify the quantity": $scope.medical.smokingQuantity = "";
	$scope.medical.smokeOrSnuff =='Yes'? $scope.medical.durationOfSmoking = "Specify in years": $scope.medical.durationOfSmoking = "";
	$scope.medical.smokeOrSnuff =='Yes'? $scope.medical.startingYearOfSmoking = "Specify in years": $scope.medical.startingYearOfSmoking = "";
}

$scope.changeDrinkAlcoholAtPresent = function()
{
	$scope.medical.drinkAlcoholAtPresent =='Yes'? $scope.medical.alcoholQuantity = "Specify the quantity": $scope.medical.alcoholQuantity = "";
	$scope.medical.drinkAlcoholAtPresent =='Yes'? $scope.medical.alcoholStartingAge = "Specify the age": $scope.medical.alcoholStartingAge = "";
}


$scope.changeExercise = function()
{
	$scope.medical.exercise =='Yes'? $scope.medical.nameOfexercise = "Specify the exercise": $scope.medical.nameOfexercise = "";
	$scope.medical.exercise =='Yes'? $scope.medical.exerciseDuration = "Duration": $scope.medical.exerciseDuration = "";
	$scope.medical.exercise =='No'? $scope.medical.howOftenExercise = "": $scope.medical.howOftenExercise = $scope.medical.howOftenExercise;
}


$scope.changeEatFruit = function()
{
	$scope.medical.eatFruit =='Yes'? $scope.medical.eatFruitQuantity = "Quantity consumed": $scope.medical.nameOfexercise = "";
}

$scope.changeEatUncookedVegetable = function()
{
	$scope.medical.eatUncookedVegetable =='Yes'? $scope.medical.eatUncookedVegetableQuantity = "Quantity consumed": $scope.medical.eatUncookedVegetableQuantity = "";
}

$scope.changeEatCookedVegetable = function()
{
	$scope.medical.eatCookedVegetable =='Yes'? $scope.medical.eatCookedVegetableQuantity = "Quantity consumed": $scope.medical.eatCookedVegetableQuantity = "";
}
$scope.changeEatPastries = function()
{
	$scope.medical.eatPastries =='Yes'? $scope.medical.eatPastriesQuantity = "Quantity consumed": $scope.medical.eatPastriesQuantity = "";
}

$scope.changeEatFried = function()
{
	$scope.medical.eatFried =='Yes'? $scope.medical.eatFriedQuantity = "Quantity consumed": $scope.medical.eatFriedQuantity = "";
}


$scope.changeSoftDrink = function()
{
	$scope.medical.softDrink =='Yes'? $scope.medical.softDrinkQuantity = "Quantity consumed": $scope.medical.softDrinkQuantity = "";
}

$scope.changeEatRedMeat = function()
{
	$scope.medical.eatRedMeat =='Yes'? $scope.medical.eatRedMeatQuantity = "Quantity consumed": $scope.medical.eatRedMeatQuantity = "";
}

$scope.changeKnowGenotype = function()
{
	$scope.medical.knowGenotype =='Yes'? $scope.medical.genotype = "Genotype": $scope.medical.genotype = "";
}
$scope.changeKnowBloodGroup = function()
{
	$scope.medical.knowBloodGroup =='Yes'? $scope.medical.bloodGroup = "Blood group": $scope.medical.bloodGroup = "";
}

$scope.isReady = false;


			/* 
	<!--(`jambRegNo`, `inpatient`, `inpatientReason`, `surgery`, `surgeryReason`, `anyMedication`, `drugAndDose`, `knowGenotype`, `genotype`, `knowBloodGroup`, `bloodGroup`, `detailsOfMedNotcovered`, `tuberculosis`, `asthma`, `pepticUlcer`, `sickleCell`, `allergies`, `diabetes`, `hypertension`, `siezure`, `mentalIllness`, `otherSicknesses`, `detailOfOtherSicknesses`, `familyTB`, `familyHypertension`, `familySeizure`, `familyDiabetes`, `familyMentalSickness`, `drugReaction`, `reactingDrug`, `immunizedHepatitisB`, `immunizedHepatitisBDate`, `immunizedYellowFever`, `immunizedYellowFeverDate`, `immunizedTetanus`, `immunizedTetanusDate`, `immunizedCSM`, `immunizedCSMDate`, `otherImmunization`, `smokeOrSnuff`, `smokingQuantity`, `durationOfSmoking`, `startingYearOfSmoking`, `neighbourSmoker`, `drinkAlcoholAtPresent`, `alcoholFrequency`, `alcoholQuantity`, `drinkAlcoholInAnyForm`, `alcoholStartingAge`, `exercise`, `nameOfexercise`, `exerciseDuration`, `howOftenExercise`, `eatFruit`, `eatFruitQuantity`, `eatUncookedVegetable`, `eatUncookedVegetableQuantity`, `eatCookedVegetable`, `eatCookedVegetableQuantity`, `eatPastries`, `eatPastriesQuantity`, `eatFried`, `eatFriedQuantity`, `softDrink`, `softDrinkQuantity`, `eatRedMeat`, `eatRedMeatQuantity`)-->

	*/
	
	
	
/* beginning of date stuff */
  $scope.clear = function () {
    $scope.applicanat1.dateOfBirth = null;
  };


  $scope.toggleMin = function() {
    $scope.minDate = $scope.minDate ? null : new Date();
  };
  $scope.toggleMin();

  $scope.open = function($event) {
    $event.preventDefault();
    $event.stopPropagation();
    //$scope.opened1 = true;
  };

  $scope.dateOptions = {
    formatYear: 'yyyy',
    startingDay: 1
  };

  $scope.formats = ['dd-MMMM-yyyy', 'yyyy/MM/dd', 'dd.MM.yyyy', 'shortDate', 'yyyy-MM-dd' ];
  $scope.format1 = $scope.formats[4];


/*
end of date stuff
*/



$scope.savePartOne = function()
{
	if($scope.medical.inpatient == "[ Select An Option ]" || ($scope.medical.inpatient == "Yes" &&($scope.medical.inpatientReason==''|| $scope.medical.inpatientReason=='Reason for admission')) || $scope.medical.surgery=="[ Select An Option ]" || ($scope.medical.surgery == "Yes" &&($scope.medical.surgeryReason==''|| $scope.medical.surgeryReason=='State where it was done and the year')) || $scope.medical.anyMedication=="[ Select An Option ]" || ($scope.medical.anyMedication == "Yes" &&($scope.medical.drugAndDose==''|| $scope.medical.drugAndDose=='State the drug and the dose')))
{
		modalMessage("Go through your questions again to see those you have not answered properly")

	
}
else
{
	sentItems = {"inpatient":$scope.medical.inpatient,
				 "inpatientReason":$scope.medical.inpatientReason,
				 "surgery":$scope.medical.surgery,
				 "surgeryReason":$scope.medical.surgeryReason,
				 "anyMedication":$scope.medical.anyMedication,
				 "drugAndDose":$scope.medical.drugAndDose,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":2

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartOne=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   alert(items)
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[0] = true;
				$scope.showpart = 2

	
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			//flashMessage();
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items});
		}) // end of error call back


}

	
}


$scope.savePartTwo = function()
{
	if($scope.medical.tuberculosis == "[ Select An Option ]" || $scope.medical.asthma=="[ Select An Option ]" ||  $scope.medical.pepticUlcer=="[ Select An Option ]" ||  $scope.medical.sickleCell=="[ Select An Option ]" ||  $scope.medical.allergies=="[ Select An Option ]" ||  $scope.medical.diabetes=="[ Select An Option ]" ||  $scope.medical.hypertension=="[ Select An Option ]"  )
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/*items = "All the fields stared are compulsory, fill them and save";
	modalMessage(items);*/
	
}
else
{
	sentItems = {"tuberculosis":$scope.medical.tuberculosis,
				 "asthma":$scope.medical.asthma,
				 "pepticUlcer":$scope.medical.pepticUlcer,
				 "sickleCell":$scope.medical.sickleCell,
				 "allergies":$scope.medical.allergies,
				 "diabetes":$scope.medical.diabetes,
				 "hypertension":$scope.medical.hypertension,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":3

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartTwo=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[1] = true;
				$scope.showpart = 3

	
			}
			else if(response1.status == "not ok")	
			{
				///alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			items = "System Error, Please check your entries";
			Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}


$scope.savePartThree = function()
{
	if($scope.medical.siezure == "[ Select An Option ]" || $scope.medical.mentalIllness=="[ Select An Option ]" ||  $scope.medical.otherailment=="[ Select An Option ]" ||  $scope.medical.familyTB=="[ Select An Option ]" ||  $scope.medical.familyHypertension=="[ Select An Option ]" ||  $scope.medical.familySeizure=="[ Select An Option ]" ||($scope.medical.otherailment == "Yes" &&($scope.medical.otherSicknesses==''|| $scope.medical.otherSicknesses=='Name of ailment(s)')) )
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/*|| ($scope.medical.otherailment=='Yes'|| $scope.medical.mentalIllness=='Yes' || $scope.medical.siezure=='Yes' ||  $scope.medical.allergies=='Yes' || $scope.medical.diabetes=='Yes'|| $scope.medical.hypertension=='Yes' || $scope.medical.sickleCell=='Yes' || $scope.medical.pepticUlcer=='Yes' || $scope.medical.asthma=='Yes' || $scope.medical.tuberculosis=='Yes' &&($scope.medical.detailOfOtherSicknesses==''|| $scope.medical.detailOfOtherSicknesses=='Details of the sickness(es) you have suffered')) work on this latter*/
	 
	
}
else
{
	sentItems = {"siezure":$scope.medical.siezure,
				 "mentalIllness":$scope.medical.mentalIllness,
				 "otherailment":$scope.medical.otherailment,
				 "familyTB":$scope.medical.familyTB,
				 "familyHypertension":$scope.medical.familyHypertension,
				 "familySeizure":$scope.medical.familySeizure,
				 "otherSicknesses":$scope.medical.otherSicknesses,
				 "detailOfOtherSicknesses":$scope.medical.detailOfOtherSicknesses,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":4

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartThree=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[2] = true;
				$scope.showpart = 4

	
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			flashMessage();
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}
	

$scope.savePartFour = function()
{
	if($scope.medical.familyDiabetes == "[ Select An Option ]" || $scope.medical.familyMentalSickness=="[ Select An Option ]" ||  $scope.medical.drugReaction=="[ Select An Option ]" ||  $scope.medical.immunizedHepatitisB=="[ Select An Option ]" ||  $scope.medical.immunizedYellowFever=="[ Select An Option ]" ||($scope.medical.drugReaction == "Yes" &&($scope.medical.reactingDrug==''|| $scope.medical.reactingDrug=='State name(s) of drug')) ||($scope.medical.immunizedHepatitisB == "Yes" && $scope.medical.immunizedHepatitisBDate=='') ||($scope.medical.immunizedYellowFever == "Yes" && $scope.medical.immunizedYellowFeverDate=='') )
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/*|| ($scope.medical.otherailment=='Yes'|| $scope.medical.mentalIllness=='Yes' || $scope.medical.siezure=='Yes' ||  $scope.medical.allergies=='Yes' || $scope.medical.diabetes=='Yes'|| $scope.medical.hypertension=='Yes' || $scope.medical.sickleCell=='Yes' || $scope.medical.pepticUlcer=='Yes' || $scope.medical.asthma=='Yes' || $scope.medical.tuberculosis=='Yes' &&($scope.medical.detailOfOtherSicknesses==''|| $scope.medical.detailOfOtherSicknesses=='Details of the sickness(es) you have suffered')) work on this latter*/
	 
	
}
else
{
	sentItems = {"familyDiabetes":$scope.medical.familyDiabetes,
				 "familyMentalSickness":$scope.medical.familyMentalSickness,
				 "drugReaction":$scope.medical.drugReaction,
				 "immunizedHepatitisB":$scope.medical.immunizedHepatitisB,
				 "immunizedYellowFever":$scope.medical.immunizedYellowFever,
				 "reactingDrug":$scope.medical.reactingDrug,
				 "immunizedHepatitisBDate":$scope.medical.immunizedHepatitisBDate,
				 "immunizedYellowFeverDate":$scope.medical.immunizedYellowFeverDate,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":5

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartFour=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[3] = true;
				$scope.showpart = 5
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}

$scope.savePartFive = function()
{
	if($scope.medical.immunizedTetanus == "[ Select An Option ]" || $scope.immunizationStuff == "[ Select An Option ]" || $scope.medical.immunizedCSM=="[ Select An Option ]" ||  $scope.medical.smokeOrSnuff=="[ Select An Option ]" ||  $scope.medical.neighbourSmoker=="[ Select An Option ]"  ||($scope.medical.immunizedTetanus == "Yes" && $scope.medical.immunizedTetanusDate=='') ||($scope.medical.immunizedCSM == "Yes" && $scope.medical.immunizedCSMDate=='')||($scope.immunizationStuff == "Yes" &&($scope.medical.otherImmunization==''|| $scope.medical.otherImmunization=='State the immunizations(s) and the date(s)')) ||($scope.medical.smokeOrSnuff == "Yes" &&($scope.medical.durationOfSmoking==''|| $scope.medical.durationOfSmoking=='Specify in years')) ||($scope.medical.smokeOrSnuff == "Yes" &&($scope.medical.startingYearOfSmoking==''|| $scope.medical.startingYearOfSmoking=='Specify in years')) || ($scope.medical.smokeOrSnuff == "Yes" &&($scope.medical.smokingQuantity==''|| $scope.medical.smokingQuantity=='Specify the quantity')))
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/*|| ($scope.medical.otherailment=='Yes'|| $scope.medical.mentalIllness=='Yes' || $scope.medical.siezure=='Yes' ||  $scope.medical.allergies=='Yes' || $scope.medical.diabetes=='Yes'|| $scope.medical.hypertension=='Yes' || $scope.medical.sickleCell=='Yes' || $scope.medical.pepticUlcer=='Yes' || $scope.medical.asthma=='Yes' || $scope.medical.tuberculosis=='Yes' &&($scope.medical.detailOfOtherSicknesses==''|| $scope.medical.detailOfOtherSicknesses=='Details of the sickness(es) you have suffered')) work on this latter*/
	 
	
}
else
{
	sentItems = {"immunizedTetanus":$scope.medical.immunizedTetanus,
				 "immunizedTetanusDate":$scope.medical.immunizedTetanusDate,
				 "immunizedCSM":$scope.medical.immunizedCSM,
				 "immunizedCSMDate":$scope.medical.immunizedCSMDate,
				 "otherImmunization":$scope.medical.otherImmunization,
				 "smokeOrSnuff":$scope.medical.smokeOrSnuff,
				 "durationOfSmoking":$scope.medical.durationOfSmoking,
				 "startingYearOfSmoking":$scope.medical.startingYearOfSmoking,
				 "neighbourSmoker":$scope.medical.neighbourSmoker,
				 "smokingQuantity":$scope.medical.smokingQuantity,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":6

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartFive=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[4] = true;
				$scope.showpart = 6
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}


$scope.savePartSix = function()
{
	if($scope.medical.drinkAlcoholAtPresent == "[ Select An Option ]" || $scope.medical.exercise=="[ Select An Option ]"||($scope.medical.drinkAlcoholAtPresent == "Yes" &&($scope.medical.alcoholQuantity==''|| $scope.medical.alcoholQuantity=='Specify the quantity'))||($scope.medical.drinkAlcoholAtPresent == "Yes" &&($scope.medical.alcoholStartingAge==''|| $scope.medical.alcoholStartingAge=='Specify the age'))||($scope.medical.exercise == "Yes" &&($scope.medical.nameOfexercise==''|| $scope.medical.nameOfexercise=='Specify the exercise'))||($scope.medical.exercise == "Yes" &&($scope.medical.exerciseDuration==''|| $scope.medical.exerciseDuration=='Duration')) )
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/* remedy this model validation || $scope.medical.drinkAlcoholInAnyForm == "[ Select An Option ]"*/
	 
	
}
else
{
	sentItems = {"drinkAlcoholAtPresent":$scope.medical.drinkAlcoholAtPresent,
				 "drinkAlcoholInAnyForm":$scope.medical.drinkAlcoholInAnyForm,
				 "exercise":$scope.medical.exercise,
				 "alcoholQuantity":$scope.medical.alcoholQuantity,
				 "alcoholStartingAge":$scope.medical.alcoholStartingAge,
				 "nameOfexercise":$scope.medical.nameOfexercise,
				 "exerciseDuration":$scope.medical.exerciseDuration,
				 
				 "howOftenExercise":$scope.medical.howOftenExercise,
				 "alcoholFrequency":$scope.medical.alcoholFrequency,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":7

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartSix=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[5] = true;
				$scope.showpart = 7

	
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}


$scope.savePartSeven = function()
{
	if($scope.medical.eatFruit == "[ Select An Option ]" 
	|| $scope.medical.eatUncookedVegetable=="[ Select An Option ]"
	|| $scope.medical.eatCookedVegetable=="[ Select An Option ]"
	|| $scope.medical.eatPastries=="[ Select An Option ]" 
	|| $scope.medical.eatFried=="[ Select An Option ]" 
	|| $scope.medical.softDrink=="[ Select An Option ]" 
	|| $scope.medical.eatRedMeat=="[ Select An Option ]" 

	||($scope.medical.eatFruit == "Yes" &&($scope.medical.eatFruitQuantity==''|| $scope.medical.eatFruitQuantity=='Quantity consumed'))
	||($scope.medical.eatUncookedVegetable == "Yes" &&($scope.medical.eatUncookedVegetableQuantity==''|| $scope.medical.eatUncookedVegetableQuantity=='Quantity consumed'))
	||($scope.medical.eatCookedVegetable == "Yes" &&($scope.medical.eatCookedVegetableQuantity==''|| $scope.medical.eatCookedVegetableQuantity=='Quantity consumed'))
	||($scope.medical.eatPastries == "Yes" &&($scope.medical.eatPastriesQuantity==''|| $scope.medical.eatPastriesQuantity=='Quantity consumed'))
	||($scope.medical.eatFried == "Yes" &&($scope.medical.eatFriedQuantity==''|| $scope.medical.eatFriedQuantity=='Quantity consumed'))
	||($scope.medical.softDrink == "Yes" &&($scope.medical.softDrinkQuantity==''|| $scope.medical.softDrinkQuantity=='Quantity consumed'))
	||($scope.medical.eatRedMeat == "Yes" &&($scope.medical.eatRedMeatQuantity==''|| $scope.medical.eatRedMeatQuantity=='Quantity consumed'))
	
	)
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/* remedy this model validation || $scope.medical.drinkAlcoholInAnyForm == "[ Select An Option ]"*/
	 
	
}
else
{
	sentItems = {"eatFruit":$scope.medical.eatFruit,
				 "eatUncookedVegetable":$scope.medical.eatUncookedVegetable,
				 "eatCookedVegetable":$scope.medical.eatCookedVegetable,
				 "eatPastries":$scope.medical.eatPastries,
				 "eatFried":$scope.medical.eatFried,
				 "softDrink":$scope.medical.softDrink,
				 "eatRedMeat":$scope.medical.eatRedMeat,
				 
				 "eatFruitQuantity":$scope.medical.eatFruitQuantity,
				 "eatUncookedVegetableQuantity":$scope.medical.eatUncookedVegetableQuantity,
				 "eatCookedVegetableQuantity":$scope.medical.eatCookedVegetableQuantity,
				 "eatPastriesQuantity":$scope.medical.eatPastriesQuantity,
				 "eatFriedQuantity":$scope.medical.eatFriedQuantity,
				 "softDrinkQuantity":$scope.medical.softDrinkQuantity,
				 "eatRedMeatQuantity":$scope.medical.eatRedMeatQuantity,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":8

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartSeven=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[6] = true;
				$scope.showpart = 8;
			}
			else if(response1.status == "not ok")	
			{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"error", "message":items})
			}
			else
			{
				//alert(response1.message)
				items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			
			items = "System Error, Please check your entries";
				   Data.toast({"status":"error", "message":items})
		}) // end of error call back


}

	
}
$scope.savePartEight = function()
{
	if($scope.medical.knowGenotype == "[ Select An Option ]" 
	|| $scope.medical.knowBloodGroup =="[ Select An Option ]"

	||($scope.medical.knowGenotype == "Yes" &&($scope.medical.genotype==''|| $scope.medical.genotype=='Genotype'))
	||($scope.medical.knowBloodGroup == "Yes" &&($scope.medical.bloodGroup==''|| $scope.medical.bloodGroup=='Blood group'))
	||($scope.medical.detailsOfMedNotcovered==''|| $scope.medical.detailsOfMedNotcovered=='Details of medical information not covered')
	
	)
{
	modalMessage("Go through your questions again to see those you have not answered properly")
	/* remedy this model validation || $scope.medical.drinkAlcoholInAnyForm == "[ Select An Option ]"*/
	 
	
}
else
{
	sentItems = {"knowGenotype":$scope.medical.knowGenotype,
				 "knowBloodGroup":$scope.medical.knowBloodGroup,
				 "genotype":$scope.medical.genotype,
				 "bloodGroup":$scope.medical.bloodGroup,
				 "detailsOfMedNotcovered":$scope.medical.detailsOfMedNotcovered,
				 "jambNumber":$scope.applicantJambNo.jambNumber,
				 "stage":9

				 
		};
		
		$http.post("backend/sqlprocessesmed.php?saveMedicalPartEight=yes", sentItems)
		.success(function(response1)
		{
			if(response1.status == "ok")
			{
				//alert(response1.message)
				   items = "Your information was saved successfully";
				   Data.toast({"status":"success", "message":items})
				/// work on this part
				$scope.buttonParts[7] = true;
				$scope.showpart=9;
				if(response1.status1 == "ok")	
				{
				$scope.medical = response1.data1
				/*items = "Your information was not saved successfully";
				modalMessage(items);*/
				}
				else if(response1.status == "not ok")	
				{
				//alert(response1.message)
				items = "Your information was not saved successfully";
				   Data.toast({"status":"success", "message":items})
				}
	
			}
			
			else
			{
				//alert(response1.message)
				/*items = "System Error, Please check your entries";
				modalMessage(items)*/
			}
		}) //end of success' call back
		.error(function(errorMessage){
			//alert(errorMessage)
			
			items = "System Error, Please check your entries";
				   Data.toast({"status":"success", "message":items})
		}) // end of error call back


}

	
}


function modalMessage(items)
{
	
		  var modalInstance = $modal.open(
		  {
			templateUrl: 'partials/alerts.html',
			controller: 'alertCtrl',
			keyboard : false,
			size:"sm",
			resolve: {
					  items: function () {
						return items;
					  }
			}
			
		  });
	
	}	
	

function modalMessageOk(items)
{
	
		  var modalInstance = $modal.open(
		  {
			templateUrl: 'partials/alertok.html',
			controller: 'alertCtrl',
			keyboard : false,
			size:"sm",
			resolve: {
					  items: function () {
						return items;
					  }
			}
			
		  });
	
	}	
	




});




myApp.controller("clearanceCtrl", function($scope, $timeout, $rootScope, $http, $location, $modal, $routeParams, Data, $localStorage)
{
	//$rootScope.content_loaded = false;
	
    //alert(1);
    
	$scope.applicant = $localStorage.bio_data;
	$scope.jambRegNo = $scope.applicant.jambRegNo;
	$scope.olevel_computation = $scope.applicant.olevel_score;
	
	$scope.applicantMode = $scope.applicant.applicantMode;
	$scope.acceptancefee = $scope.applicant.acceptancefee;
	
	if($scope.acceptancefee != "paid"){
	    $location.path("applicant/applicant-dashboard/");
	}
	
	$scope.clearanceStage = 1;
	
	//alert($scope.olevel_computation);
	
	$scope.applicant_name = $scope.applicant.surname+", "+$scope.applicant.firstname+" "+$scope.applicant.middlename;
	$scope.buttonParts = ["dummy",false,false,false,false,false,false,false, false,false, false];
	$scope.nationality = ["[ Select Nationality ]"];
	$scope.phoneNumbr = /\d{11}/
	
	$scope.pages_arr = Array();
	
	/*if($scope.applicantMode == "UTME"){
		$scope.pages_arr[0] = {id: 0, page_title: "Instructions", fpage_title: "Instructions"};
		$scope.pages_arr[1] = {id: 1, page_title: "Passport", fpage_title: "PASSPORT PHOTOGRAPH"};
		$scope.pages_arr[2] = {id: 2, page_title: "Birth Certificate", fpage_title: "Birth Certificate or Attestation"};
		$scope.pages_arr[3] = {id: 3, page_title: "O Level Result(s)", fpage_title: "WAEC / NECO O/L RESULT(S)"};
		$scope.pages_arr[4] = {id: 4, page_title: "Scratch Card(s)", fpage_title: "WAEC/NECO SCRATCH CARD showing PIN AND SERIAL NUMBER"};
		$scope.pages_arr[5] = {id: 6, page_title: "Immunization Card", fpage_title: "IMMUNIZATION CARD (FRONT PAGE)"};
		$scope.pages_arr[6] = {id: 7, page_title: "Jamb Form  03", fpage_title: "JAMB FORM  03"};
		$scope.pages_arr[7] = {id: 8, page_title: "Admission Letter", fpage_title: "ADMISSION LETTER (INSTITUTION COPY)"};
		$scope.pages_arr[8] = {id: 9, page_title: "Guarantor(s) Letter", fpage_title: "GUARANTORS LETTER FROM TWO REPUTABLE PERSONALITIES (Letter should be on letter head paper)"};
		$scope.pages_arr[9] = {id: 10, page_title: "Attestation", fpage_title: "ATTESTATION OF PERSONAL UNDERTAKING FOR PROVISIONAL ADMISSION"};
	}
	else{
		$scope.pages_arr[0] = {id: 0, page_title: "Instructions", fpage_title: "Instructions"};
		$scope.pages_arr[1] = {id: 1, page_title: "Passport", fpage_title: "PASSPORT PHOTOGRAPH"};
		$scope.pages_arr[2] = {id: 2, page_title: "Birth Certificate", fpage_title: "Birth Certificate or Attestation"};
		$scope.pages_arr[3] = {id: 3, page_title: "O Level Result(s)", fpage_title: "WAEC / NECO O/L RESULT(S)"};
		$scope.pages_arr[4] = {id: 4, page_title: "Scratch Card(s)", fpage_title: "WAEC/NECO SCRATCH CARD showing PIN AND SERIAL NUMBER"};
		$scope.pages_arr[5] = {id: 5, page_title: "Post Secondary Results", fpage_title: "A/L / NCE / ND / HND / DEGREE RESULTS"};
		$scope.pages_arr[6] = {id: 6, page_title: "Immunization Card", fpage_title: "IMMUNIZATION CARD (FRONT PAGE)"};
		$scope.pages_arr[7] = {id: 7, page_title: "Jamb Form  03", fpage_title: "JAMB FORM  03"};
		$scope.pages_arr[8] = {id: 8, page_title: "Admission Letter", fpage_title: "ADMISSION LETTER (INSTITUTION COPY)"};
		$scope.pages_arr[9] = {id: 9, page_title: "Guarantor(s) Letter", fpage_title: "GUARANTORS LETTER FROM TWO REPUTABLE PERSONALITIES (Letter should be on letter head paper)"};
		$scope.pages_arr[10] = {id: 10, page_title: "Attestation", fpage_title: "ATTESTATION OF PERSONAL UNDERTAKING FOR PROVISIONAL ADMISSION"};
	}*/
	
	/*$scope.pages_arr[0] = {id: 0, page_title: "Instructions", fpage_title: "Instructions"};
	$scope.pages_arr[1] = {id: 1, page_title: "Passport", fpage_title: "PASSPORT PHOTOGRAPH"};
	//$scope.pages_arr[2] = {id: 2, page_title: "Birth Certificate", fpage_title: "Birth Certificate or Attestation"};
	$scope.pages_arr[2] = {id: 3, page_title: "O Level Result(s)", fpage_title: "WAEC / NECO O/L RESULT(S)"};
	$scope.pages_arr[3] = {id: 4, page_title: "Scratch Card(s)", fpage_title: "WAEC/NECO SCRATCH CARD showing PIN AND SERIAL NUMBER"};
	//$scope.pages_arr[5] = {id: 6, page_title: "Immunization Card", fpage_title: "IMMUNIZATION CARD (FRONT PAGE)"};
	$scope.pages_arr[4] = {id: 7, page_title: "Jamb Form  03", fpage_title: "JAMB FORM  03"};
	$scope.pages_arr[5] = {id: 8, page_title: "Admission Letter", fpage_title: "ADMISSION LETTER (INSTITUTION COPY)"};
	//$scope.pages_arr[8] = {id: 9, page_title: "Guarantor(s) Letter", fpage_title: "GUARANTORS LETTER FROM TWO REPUTABLE PERSONALITIES (Letter should be on letter head paper)"};
	//$scope.pages_arr[5] = {id: 10, page_title: "Attestation", fpage_title: "ATTESTATION OF PERSONAL UNDERTAKING FOR PROVISIONAL ADMISSION"};*/
	
	
	$scope.pages_arr[0] = {id: 0, page_title: "Instructions", fpage_title: "Instructions"};
	//$scope.pages_arr[1] = {id: 1, page_title: "Passport", fpage_title: "PASSPORT PHOTOGRAPH"};
	//$scope.pages_arr[2] = {id: 2, page_title: "Birth Certificate", fpage_title: "Birth Certificate or Attestation"};
	$scope.pages_arr[1] = {id: 3, page_title: "O Level Result(s)", fpage_title: "WAEC / NECO O/L RESULT(S)"};
	$scope.pages_arr[2] = {id: 4, page_title: "Scratch Card(s)", fpage_title: "WAEC/NECO SCRATCH CARD showing PIN AND SERIAL NUMBER"};
	//$scope.pages_arr[5] = {id: 6, page_title: "Immunization Card", fpage_title: "IMMUNIZATION CARD (FRONT PAGE)"};
	//$scope.pages_arr[4] = {id: 7, page_title: "Jamb Form  03", fpage_title: "JAMB FORM  03"};
	$scope.pages_arr[3] = {id: 8, page_title: "Admission Letter", fpage_title: "ADMISSION LETTER (INSTITUTION COPY)"};
	//$scope.pages_arr[8] = {id: 9, page_title: "Guarantor(s) Letter", fpage_title: "GUARANTORS LETTER FROM TWO REPUTABLE PERSONALITIES (Letter should be on letter head paper)"};
	//$scope.pages_arr[5] = {id: 10, page_title: "Attestation", fpage_title: "ATTESTATION OF PERSONAL UNDERTAKING FOR PROVISIONAL ADMISSION"};
	
	$scope.passport_change = false;
	$scope.passport_uploaded = "";
	$scope.passport_scanned = "";
	
	$scope.birth_change = false;
	$scope.birth_uploaded = "";
	$scope.birth_scanned = "";
	
	$scope.olevel_add = false;
	$scope.unlinked_waec_neco = Array();
	$scope.olevel_uploaded = "";
	$scope.olevel_scanned = "";
	
	$scope.card_add = false;
	$scope.card_uploaded = "";
	$scope.card_scanned = "";
	
	$scope.post_sec_change = false;
	$scope.post_sec_uploaded = "";
	$scope.post_sec_scanned = "";
	
	$scope.post_sec_stages = 1;
	$scope.post_sec_panel = 1;
	
	$scope.immunization_change = false;
	$scope.immunization_uploaded = "";
	$scope.immunization_scanned = "";
	
	$scope.jamb_form_change = false;
	$scope.jamb_form_uploaded = "";
	$scope.jamb_form_scanned = "";
	
	$scope.admission_letter_change = false;
	$scope.admission_letter_uploaded = "";
	$scope.admission_letter_scanned = "";
	
	$scope.guarantor_add = false;
	$scope.guarantor_uploaded = "";
	$scope.guarantor_scanned = "";
	
	$scope.attestation_change = false;
	$scope.attestation_uploaded = "";
	$scope.attestation_scanned = "";
	
	$scope.applicant1 = $scope.applicant;
	$scope.day = "[ Day ]";
	$scope.month = "[ Month ]";
	$scope.year = "[ Year ]";
	$scope.days = ["[ Day ]"];
	//$scope.months = ["[ Month ]"];
	$scope.years1 = ["[ Year ]"];
	$scope.years2 = ["[ Year ]"];
	

	// initialization of years 
	for( i=1960; i<=2005; i++){
		$scope.years1.push(i);
	}
	
	
	// initialization of years 
	for( i=1940; i<=2018; i++){
		$scope.years2.push(i);
	}
	
	$scope.months = ["January","February","March","April","May","June","July","August","September","October","November","December"];
	
	$scope.years = [];
	today = new Date();
	thisYear = today.getFullYear();
	
	/*for (i=1970; i<= thisYear; i++){
		$scope.years.push(i);
	}*/
	
	for (i=thisYear; i>= 1970; i--){
		$scope.years.push(i);
	}
	
	
	$scope.examination = {"jambNumber": $scope.jambRegNo,
							"sitting":$scope.sittingNumber,
							"year":"[ Select Examination Year ]",
							"type":"[ Select Examination Type ]",
							"month":"[ Select Examination Month ]",
							"center":"",
							"number":""};	
	
	$scope.examinationType = ["CAMBRIDGE GCE", "IGCSE", "NECO", "WAEC"];
	
	
	$scope.post_sec = {"jambRegNo": $scope.jambRegNo,
							"type":"",
							"year":"",
							"center":""};	
	
	
	// initialization of days 
	for( i=1; i<=31; i++){
		if(i<10){
			$scope.days.push("0" + i );
		}
		else{
			$scope.days.push(i);
		}
	}
	
	$scope.openDV = function(pos){
		//alert(pos);
		//$rootScope.isMain = false;
		$scope.pos = pos;
		if($scope.pos == '11'){
			if($scope.clearanceDets.olevels > 0 && $scope.unlinked_waec_neco.length == 0){
				$scope.current_page = $scope.pages_arr[pos];
				$scope.pge_pos = 11;
			}
			/*if($scope.clearanceDets.olevels > 0 && $scope.clearanceDets.guarantors == 2 && $scope.unlinked_waec_neco.length == 0){
				$scope.current_page = $scope.pages_arr[pos];
				$scope.pge_pos = 11;
			}*/
			else if($scope.clearanceDets.olevels == 0){
				$scope.current_page = $scope.pages_arr[1];
				$scope.pge_pos = $scope.current_page.id;
				$scope.pos = $scope.current_page.id;
			}
			else if($scope.unlinked_waec_neco.length > 0){
				$scope.current_page = $scope.pages_arr[2];
				$scope.pge_pos = $scope.current_page.id;
				$scope.pos = $scope.current_page.id;
			}
			else{
				if($scope.applicantMode == 'UTME'){
					position = 8;
				}
				else{
					position = 8;
				}
				
				$scope.current_page = $scope.pages_arr[position];
				$scope.pge_pos = $scope.current_page.id;
				$scope.pos = $scope.current_page.position;
			}
		}
// 		else if($scope.pos == '1'){
// 		    $scope.current_page = $scope.pages_arr[1];
// 			$scope.pge_pos = $scope.current_page.id;
// 		}
		else{
			for(var j = 0; j < $scope.pages_arr.length; j++){
				if($scope.pages_arr[j].id == $scope.pos){
					//alert($scope.pos);
					//$scope.current_page = $scope.pages_arr[pos];
					$scope.current_page = $scope.pages_arr[j];
					$scope.pge_pos = $scope.current_page.id;
				}
			}
		}
		
	};
	
	$scope.openDV($scope.clearanceStage);
	
	
	$scope.birth_cert_type = "birth";
	
	$http.post("backend/authentication.php?action=getClearanceDetails&&jambRegNo="+$scope.jambRegNo)
	.success(function(data){
		$rootScope.content_loaded = false;
		
		if(data.status == "success"){
			$scope.clearanceDets = data.clearanceDets;
			
			//alert($scope.clearanceDets.status);
			
			$scope.post_sec_stages = 1;
			
			$scope.olevels = data.olevels;
			$scope.scratch_cards = data.scratch_cards;
			$scope.post_secondary = data.post_secondary;
			$scope.guarantors = data.guarantors;
			
			$scope.birth_cert_type = $scope.clearanceDets.birth_cert_type
			
			t = 0;
			$scope.unlinked_waec_neco = Array();
			
			for(var i = 0; i < $scope.olevels.length; i++){
				if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
					if($scope.olevels[i].linked_card_id == ""){
						$scope.unlinked_waec_neco[t] = {
															number:$scope.olevels[i].number,
															label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
														};
						t++;
					}
				}
				
				$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
			}
			
			//alert(JSON.stringify($scope.unlinked_waec_neco));
			
			for(var i = 0; i < $scope.scratch_cards.length; i++){
				$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
			}
			
			for(var i = 0; i < $scope.post_secondary.length; i++){
				$scope.post_secondary[i].post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].upload+"?"+Date();
				
				if($scope.post_secondary[i].type == "DEGREE" || $scope.post_secondary[i].type == "HND"){
					if($scope.post_secondary[i].nysc_completed == "Yes"){
						$scope.post_secondary[i].nysc_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].nysc_upload+"?"+Date();
					}
				}
			}
			
			for(var i = 0; i < $scope.guarantors.length; i++){
				$scope.guarantors[i].guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.guarantors[i].upload+"?"+Date();
			}
			
			if($scope.clearanceDets.passport != ""){
				$scope.passport_change = false;
				$scope.passport_uploaded = $scope.clearanceDets.passport;
				$scope.passport_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.passport+"?"+Date();
			}
			
			if($scope.clearanceDets.birth_cert_type != ""){
				$scope.birth_change = false;
				$scope.birth_uploaded = $scope.clearanceDets.birth_cert;
				$scope.birth_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.birth_cert+"?"+Date();
			}
			
			if($scope.clearanceDets.immunization_card != ""){
				$scope.immunization_change = false;
				$scope.immunization_uploaded = $scope.clearanceDets.immunization_card;
				$scope.immunization_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.immunization_card+"?"+Date();
			}
			
			if($scope.clearanceDets.jamb_form != ""){
				$scope.jamb_form_change = false;
				$scope.jamb_form_uploaded = $scope.clearanceDets.jamb_form;
				$scope.jamb_form_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.jamb_form+"?"+Date();
			}
			
			if($scope.clearanceDets.admission_letter != ""){
				$scope.admission_letter_change = false;
				$scope.admission_letter_uploaded = $scope.clearanceDets.admission_letter;
				$scope.admission_letter_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.admission_letter+"?"+Date();
			}
			
			if($scope.clearanceDets.attestation != ""){
				$scope.attestation_change = false;
				$scope.attestation_uploaded = $scope.clearanceDets.attestation;
				$scope.attestation_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.attestation+"?"+Date();
			}
			
			$scope.clearanceStage = $scope.clearanceDets.clearance_level;
			$scope.openDV($scope.clearanceStage);
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(errorMessage){
		$rootScope.content_loaded = true;
		Data.toast(data);
	});
	
	$scope.changeUpload = function(type){  
		if(type == "pass"){
			$scope.passport_change = true;
		} 
		if(type == "birth"){
			$scope.birth_change = true;
		}
		if(type == "card"){
			$scope.card_change = true;
		}
		if(type == "post_sec"){
			$scope.post_sec_change = true;
			$scope.post_sec_panel = 1;
		}
		if(type == "attestation"){
			$scope.attestation_change = true;
		}
		if(type == "immunization"){
			$scope.immunization_change = true;
		}
		if(type == "jamb_form"){
			$scope.jamb_form_change = true;
		}
		if(type == "admission_letter"){
			$scope.admission_letter_change = true;
		}
		else{
			
		}
	}
	
	$scope.cancelChangeUpload = function(type){
		if(type == "pass"){
			$scope.passport_change = false;
		} 
		if(type == "birth"){
			$scope.birth_change = false;
		}
		if(type == "card"){
			$scope.card_change = false;
		}
		if(type == "post_sec"){
			for(var i = 0; i < $scope.post_secondary.length; i++){
				$scope.post_secondary[i].post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].upload+"?"+Date();
				
				if($scope.post_secondary[i].type == "DEGREE" || $scope.post_secondary[i].type == "HND"){
					if($scope.post_secondary[i].nysc_completed == "Yes"){
						$scope.post_secondary[i].nysc_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].nysc_upload+"?"+Date();
					}
				}
			}
			
			$scope.post_sec_change = false;
			$scope.post_sec_panel = 1;
		}
		if(type == "attestation"){
			$scope.attestation_change = false;
		}
		if(type == "immunization"){
			$scope.immunization_change = false;
		}
		if(type == "jamb_form"){
			$scope.jamb_form_change = false;
		}
		if(type == "admission_letter"){
			$scope.admission_letter_change = false;
		}
		else{
			
		}
	}
	
	$scope.addOLevel = function(status){
		$scope.olevel_add = status;
	}
	
	$scope.postSecTypeSelected = function(){
		if($scope.post_sec.type == "DEGREE" || $scope.post_sec.type == "HND"){
			$scope.post_sec_stages = 2;
		}
		else{
			$scope.post_sec_stages = 1;
		}
		
		//alert($scope.post_sec_stages);
	}
	
	$scope.openPostSecPanel = function(panel){
		$scope.post_sec_panel = panel;
	}
	
	$scope.addGuarantor = function(status){
		$scope.guarantor_add = status;
	}
	
	$scope.addCard = function(status){
		$scope.card_add = status;
	}
	
	$scope.pickupthefile1 = function(files){  
		var fd11 = new FormData();
		fd11.append("file", files[0]);
		$scope.fd11 = fd11;
	}
	
	/*$scope.pickupthefile2 = function(files){  
		var fd22 = new FormData();
		fd22.append("file", files[0]);
		$scope.fd22 = fd22;
	}*/
	
	$scope.uploadDocument = function(type){
		$scope.upl_file = $scope.fd11;
		
		if($scope.upl_file===undefined){
			//alert("Please choose a file first before upload");
			message_code = {status: 'error', message: 'Error. No file was chosen to be uploaded.'};
			Data.toast(message_code);
		}
		else{
			$rootScope.content_loaded = false;
			$scope.unsaved = "";
			
			// send the file to the backend
			$http.post("backend/upload_clearance.php?jambRegNo="+$scope.jambRegNo+"&&upload_type="+type, $scope.upl_file, {withCredentials: true, headers: {'Content-Type': undefined },transformRequest: angular.identity })
			.success(function(data){
				//$rootScope.content_loaded = true;
				
				Data.toast(data);
				if(data.status == "success"){
					if(type == "pass"){
						$scope.passport_uploaded = data.file_name;
						$scope.passport_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.passport_change = false;
						//$scope.clearanceDets.passport = data.clearanceDets;
						//alert(JSON.stringify($scope.clearanceDets));
					}
					else if(type == "birth"){
						$scope.birth_uploaded = data.file_name;
						$scope.birth_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.birth_change = false;
					}
					else if(type == "olevel"){
						$scope.olevel_uploaded = data.file_name;
						$scope.olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						//$scope.olevel_add = false;
					}
					else if(type == "card"){
						$scope.card_uploaded = data.file_name;
						$scope.card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						//$scope.card_change = false;
					}
					else if(type == "p_sec"){
						$scope.post_sec_uploaded = data.file_name;
						$scope.post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						//$scope.card_change = false;
					}
					else if(type == "nysc"){
						$scope.nysc_uploaded = data.file_name;
						$scope.nysc_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						//$scope.card_change = false;
					}
					else if(type == "guarantor"){
						$scope.guarantor_uploaded = data.file_name;
						$scope.guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						//$scope.card_change = false;
					}
					else if(type == "immunization"){
						$scope.immunization_uploaded = data.file_name;
						$scope.immunization_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.immunization_change = false;
					}
					else if(type == "jamb_form"){
						$scope.jamb_form_uploaded = data.file_name;
						$scope.jamb_form_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.jamb_form_change = false;
					}
					else if(type == "admission_letter"){
						$scope.admission_letter_uploaded = data.file_name;
						$scope.admission_letter_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.admission_letter_change = false;
					}
					else if(type == "attestation"){
						$scope.attestation_uploaded = data.file_name;
						$scope.attestation_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+data.file_name+"?"+Date();
						$scope.attestation_change = false;
					}
					else{
						
					}
				}
				
				$rootScope.content_loaded = true;
			})
			.error(function(errorMessage){
				$rootScope.content_loaded = true;
				Data.toast(data);
			});
		}
	}
	
	$scope.saveOlevelResult = function(olevel){
		$rootScope.content_loaded = false;
		
		$http.post("backend/authentication.php?action=save_clearance_olevel&&jambRegNo="+$scope.jambRegNo+"&&upload="+$scope.olevel_uploaded, olevel)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.olevels = data.olevels;
				
				$scope.olevel_uploaded = "";
				$scope.olevel_add = false;
				$scope.waec_results = 0;
				
				/*for(var i = 0; i < $scope.olevels.length; i++){
					if($scope.olevels[i].type == "WAEC"){
						$scope.waec_results++;
					}
					
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}*/
				
				t = 0;
				$scope.unlinked_waec_neco = Array();
				
				for(var i = 0; i < $scope.olevels.length; i++){
					if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
						if($scope.olevels[i].linked_card_id == ""){
							$scope.unlinked_waec_neco[t] = {
																number:$scope.olevels[i].number,
																label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
															};
							t++;
						}
					}
					
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}
				
				for(var i = 0; i < $scope.scratch_cards.length; i++){
					$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.saveScratchCard = function(card){
		$rootScope.content_loaded = false;
		
		$http.post("backend/authentication.php?action=save_clearance_scratch_cards&&jambRegNo="+$scope.jambRegNo+"&&upload="+$scope.card_uploaded, card)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.scratch_cards = data.scratch_cards;
				$scope.olevels = data.olevels;
				
				$scope.card_uploaded = "";
				$scope.card_add = false;
				
				t = 0;
				$scope.unlinked_waec_neco = Array();
				
				for(var i = 0; i < $scope.olevels.length; i++){
					if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
						if($scope.olevels[i].linked_card_id == ""){
							$scope.unlinked_waec_neco[t] = {
																number:$scope.olevels[i].number,
																label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
															};
							t++;
						}
					}
					
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}
				
				for(var i = 0; i < $scope.scratch_cards.length; i++){
					$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.savePostSecResult = function(post_sec){
		$rootScope.content_loaded = false;
		
		$http.post("backend/authentication.php?action=save_clearance_post_sec&&jambRegNo="+$scope.jambRegNo+"&&upload="+$scope.post_sec_uploaded+"&&nysc_upload="+$scope.nysc_uploaded, post_sec)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.post_secondary = data.post_secondary;
				
				$scope.post_sec_uploaded = "";
				$scope.post_sec_change = false;
				
				$scope.nysc_uploaded = "";
				
				for(var i = 0; i < $scope.post_secondary.length; i++){
					$scope.post_secondary[i].post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].upload+"?"+Date();
					
					if($scope.post_secondary[i].type == "DEGREE" || $scope.post_secondary[i].type == "HND"){
						if($scope.post_secondary[i].nysc_completed == "Yes"){
							$scope.post_secondary[i].nysc_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].nysc_upload+"?"+Date();
						}
					}
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.saveGuarantor = function(guarantor){
		$rootScope.content_loaded = false;
		
		$http.post("backend/authentication.php?action=save_clearance_guarantor&&jambRegNo="+$scope.jambRegNo+"&&upload="+$scope.guarantor_uploaded, guarantor)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.guarantors = data.guarantors;
				
				$scope.guarantor_uploaded = "";
				$scope.guarantor_add = false;
				
				for(var i = 0; i < $scope.guarantors.length; i++){
					$scope.guarantors[i].guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.guarantors[i].upload+"?"+Date();
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}

	$scope.deleteOlevelResult = function(id){
		$rootScope.content_loaded = false;
		
		$http.get("backend/authentication.php?action=delete_clearance_olevel&&jambRegNo="+$scope.jambRegNo+"&&id="+id)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.olevels = data.olevels;
				$scope.scratch_cards = data.scratch_cards;
				
				$scope.olevel_uploaded = "";
				$scope.olevel_add = false;
				
				/*for(var i = 0; i < $scope.olevels.length; i++){
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}*/
				
				t = 0;
				$scope.unlinked_waec_neco = Array();
				
				for(var i = 0; i < $scope.olevels.length; i++){
					if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
						if($scope.olevels[i].linked_card_id == ""){
							$scope.unlinked_waec_neco[t] = {
																number:$scope.olevels[i].number,
																label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
															};
							t++;
						}
					}
					
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}
				
				for(var i = 0; i < $scope.scratch_cards.length; i++){
					$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
				}
				
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.deleteGuarantor = function(id){
		$rootScope.content_loaded = false;
		
		$http.get("backend/authentication.php?action=delete_clearance_guarantor&&jambRegNo="+$scope.jambRegNo+"&&id="+id)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.guarantors = data.guarantors;
				
				$scope.guarantor_uploaded = "";
				$scope.guarantor_add = false;
				
				for(var i = 0; i < $scope.guarantors.length; i++){
					$scope.guarantors[i].guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.guarantors[i].upload+"?"+Date();
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.deleteScratchCard = function(id){
		$rootScope.content_loaded = false;
		
		$http.get("backend/authentication.php?action=delete_scratch_card&&jambRegNo="+$scope.jambRegNo+"&&id="+id)
		.success(function(data){
			
			if(data.status == "success"){
				$scope.clearanceDets = data.clearanceDets;
				$scope.scratch_cards = data.scratch_cards;
				$scope.olevels = data.olevels;
				
				$scope.card_uploaded = "";
				$scope.card_add = false;
				
				t = 0;
				$scope.unlinked_waec_neco = Array();
				
				for(var i = 0; i < $scope.olevels.length; i++){
					if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
						if($scope.olevels[i].linked_card_id == ""){
							$scope.unlinked_waec_neco[t] = {
																number:$scope.olevels[i].number,
																label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
															};
							t++;
						}
					}
					
					$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
				}
				
				for(var i = 0; i < $scope.scratch_cards.length; i++){
					$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
				}
			}
			
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
		.error(function(errorMessage){
			$rootScope.content_loaded = true;
			Data.toast(data);
		})
	}
	
	$scope.continueClearance = function(type, upload, level){
		if($scope.clearanceDets.clearance_level > level){
			level = $scope.clearanceDets.clearance_level;
		}
		
		if(type == "instructions"){
			$scope.clearanceDets.clearance_level = level;
			$scope.clearanceStage = $scope.clearanceDets.clearance_level;		
			
			$scope.openDV($scope.clearanceStage);
		}
		else{
			birth_type = "";
			
			if(type == "birth"){
				birth_type = $scope.birth_cert_type;
			}
			
			$rootScope.content_loaded = false;
			
			$http.post("backend/authentication.php?action=updateClearanceDetails&&jambRegNo="+$scope.jambRegNo+"&&field="+type+"&&content="+upload+"&&clearance_level="+level+"&&birth_type="+birth_type)
			.success(function(data){
				//$rootScope.content_loaded = true;
				
				if(data.status == "success"){
					$scope.clearanceDets = data.clearanceDets;
					$scope.olevels = data.olevels;
					$scope.scratch_cards = data.scratch_cards;
					$scope.post_secondary = data.post_secondary;
					$scope.guarantors = data.guarantors;
					
					
					if($scope.clearanceDets.passport != ""){
						$scope.passport_change = false;
						$scope.passport_uploaded = $scope.clearanceDets.passport;
						$scope.passport_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.passport+"?"+Date();
					}
					
					if($scope.clearanceDets.birth_cert_type != ""){
						$scope.birth_change = false;
						$scope.birth_uploaded = $scope.clearanceDets.birth_cert;
						$scope.birth_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.birth_cert+"?"+Date();
					}
					
					if($scope.clearanceDets.immunization_card != ""){
						$scope.immunization_change = false;
						$scope.immunization_uploaded = $scope.clearanceDets.immunization_card;
						$scope.immunization_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.immunization_card+"?"+Date();
					}
					
					if($scope.clearanceDets.jamb_form != ""){
						$scope.jamb_form_change = false;
						$scope.jamb_form_uploaded = $scope.clearanceDets.jamb_form;
						$scope.jamb_form_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.jamb_form+"?"+Date();
					}
					
					if($scope.clearanceDets.admission_letter != ""){
						$scope.admission_letter_change = false;
						$scope.admission_letter_uploaded = $scope.clearanceDets.admission_letter;
						$scope.admission_letter_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.admission_letter+"?"+Date();
					}
					
					if($scope.clearanceDets.attestation != ""){
						$scope.attestation_change = false;
						$scope.attestation_uploaded = $scope.clearanceDets.attestation;
						$scope.attestation_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.attestation+"?"+Date();
					}
					
					/*for(var i = 0; i < $scope.olevels.length; i++){
						$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
					}*/
					
					t = 0;
					$scope.unlinked_waec_neco = Array();
					
					for(var i = 0; i < $scope.olevels.length; i++){
						if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
							if($scope.olevels[i].linked_card_id == ""){
								$scope.unlinked_waec_neco[t] = {
																	number:$scope.olevels[i].number,
																	label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
																};
								t++;
							}
						}
						
						$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
					}
					
					for(var i = 0; i < $scope.scratch_cards.length; i++){
						$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
					}
					
					for(var i = 0; i < $scope.post_secondary.length; i++){
						$scope.post_secondary[i].post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].upload+"?"+Date();
						
						if($scope.post_secondary[i].type == "DEGREE" || $scope.post_secondary[i].type == "HND"){
							if($scope.post_secondary[i].nysc_completed == "Yes"){
								$scope.post_secondary[i].nysc_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].nysc_upload+"?"+Date();
							}
						}
					}
					
					for(var i = 0; i < $scope.guarantors.length; i++){
						$scope.guarantors[i].guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.guarantors[i].upload+"?"+Date();
					}
					
					$scope.clearanceStage = $scope.clearanceDets.clearance_level;
					$scope.openDV($scope.clearanceStage);
				}
				
				$rootScope.content_loaded = true;
				Data.toast(data);
			})
			.error(function(errorMessage){
				$rootScope.content_loaded = true;
				Data.toast(data);
			});
		}
	}
	
	$scope.acceptAttestation = function(){
		//if($scope.clearanceDets.olevels > 0 && $scope.clearanceDets.guarantors == 2){
		if($scope.clearanceDets.olevels > 0){
			$rootScope.content_loaded = false;
			$http.get("backend/authentication.php?action=updateClearanceCompletion&&jambRegNo="+$scope.jambRegNo)
			.success(function(data){
				if(data.status == "success"){
					$scope.clearanceDets = data.clearanceDets;
				}
				
				$rootScope.content_loaded = true;
				Data.toast(data);
			})
			.error(function(errorMessage){
				$rootScope.content_loaded = true;
				Data.toast(data);
			});
		}
		else if($scope.clearanceDets.olevels == 0){
			$scope.openDV(3);
		}
		else if($scope.clearanceDets.scratch_cards < $scope.unlinked_waec_neco.length){
			$scope.openDV(4);
		}
		else{
			$scope.openDV(11);			
		}
			
	}
	
});

myApp.controller("clearanceEvidenceCtrl", function($scope, $http, $timeout, $routeParams, $rootScope, $localStorage)
{
	$rootScope.content_loaded = false;
		
	$scope.applicant = $localStorage.bio_data;
	$scope.jambRegNo = $scope.applicant.jambRegNo;
	$scope.olevel_computation = $scope.applicant.olevel_score;
	
	$scope.applicantMode = $scope.applicant.applicantMode;
	
	$scope.applicant_name = $scope.applicant.surname+", "+$scope.applicant.firstname+" "+$scope.applicant.middlename;
	$scope.buttonParts = ["dummy",false,false,false,false,false,false,false, false,false, false];
	$scope.nationality = ["[ Select Nationality ]"];
	$scope.phoneNumbr = /\d{11}/
	
	
	$scope.passport_change = false;
	$scope.passport_uploaded = "";
	$scope.passport_scanned = "";
	
	$scope.birth_change = false;
	$scope.birth_uploaded = "";
	$scope.birth_scanned = "";
	
	$scope.olevel_add = false;
	$scope.olevel_uploaded = "";
	$scope.olevel_scanned = "";
	
	$scope.card_add = false;
	$scope.card_uploaded = "";
	$scope.card_scanned = "";
	
	$scope.post_sec_change = false;
	$scope.post_sec_uploaded = "";
	$scope.post_sec_scanned = "";
	
	$scope.immunization_change = false;
	$scope.immunization_uploaded = "";
	$scope.immunization_scanned = "";
	
	$scope.jamb_form_change = false;
	$scope.jamb_form_uploaded = "";
	$scope.jamb_form_scanned = "";
	
	$scope.admission_letter_change = false;
	$scope.admission_letter_uploaded = "";
	$scope.admission_letter_scanned = "";
	
	$scope.guarantor_add = false;
	$scope.guarantor_uploaded = "";
	$scope.guarantor_scanned = "";
	
	$scope.attestation_change = false;
	$scope.attestation_uploaded = "";
	$scope.attestation_scanned = "";
	
	
	//$rootScope.content_loaded = false;
	$http.post("backend/authentication.php?action=getClearanceDetails&&jambRegNo="+$scope.jambRegNo)
	.success(function(data){
		
		if(data.status == "success"){
			$scope.clearanceDets = data.clearanceDets;
			
			$scope.olevels = data.olevels;
			$scope.scratch_cards = data.scratch_cards;
			$scope.post_secondary = data.post_secondary;
			$scope.guarantors = data.guarantors;
			$scope.passport = data.passport;
			
			/*for(var i = 0; i < $scope.olevels.length; i++){
				$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
			}*/
			
			$scope.passport_scanned = "photo_jamb/"+$scope.jambRegNo+"_Face.jpg";
			
			
			$scope.passport_scanned2 = "photo_jamb/"+$scope.jambRegNo+" _Face.jpg";
			
			$scope.unlinked_waec_neco = Array();
			for(var i = 0; i < $scope.olevels.length; i++){
				if($scope.olevels[i].type == "WAEC" || $scope.olevels[i].type == "NECO"){
					if($scope.olevels[i].linked_card_id == ""){
						$scope.unlinked_waec_neco[t] = {
															number:$scope.olevels[i].number,
															label:$scope.olevels[i].number+" - "+$scope.olevels[i].type+" "+$scope.olevels[i].month+", "+$scope.olevels[i].year
														};
						t++;
					}
				}
				
				$scope.olevels[i].olevel_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.olevels[i].upload+"?"+Date();
			}
			
			for(var i = 0; i < $scope.scratch_cards.length; i++){
				$scope.scratch_cards[i].card_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.scratch_cards[i].upload+"?"+Date();
			}
			
			for(var i = 0; i < $scope.post_secondary.length; i++){
				$scope.post_secondary[i].post_sec_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.post_secondary[i].upload+"?"+Date();
			}
			
			for(var i = 0; i < $scope.guarantors.length; i++){
				$scope.guarantors[i].guarantor_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.guarantors[i].upload+"?"+Date();
			}
			
			if($scope.clearanceDets.passport != ""){
				$scope.passport_uploaded = $scope.clearanceDets.passport;
				$scope.passport_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.passport+"?"+Date();
			}
			
			if($scope.clearanceDets.birth_cert_type != ""){
				$scope.birth_uploaded = $scope.clearanceDets.birth_cert;
				$scope.birth_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.birth_cert+"?"+Date();
			}
			
			if($scope.clearanceDets.immunization_card != ""){
				$scope.immunization_uploaded = $scope.clearanceDets.immunization_card;
				$scope.immunization_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.immunization_card+"?"+Date();
			}
			
			if($scope.clearanceDets.jamb_form != ""){
				$scope.jamb_form_uploaded = $scope.clearanceDets.jamb_form;
				$scope.jamb_form_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.jamb_form+"?"+Date();
			}
			
			if($scope.clearanceDets.admission_letter != ""){
				$scope.admission_letter_uploaded = $scope.clearanceDets.admission_letter;
				$scope.admission_letter_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.admission_letter+"?"+Date();
			}
			
			if($scope.clearanceDets.attestation != ""){
				$scope.attestation_uploaded = $scope.clearanceDets.attestation;
				$scope.attestation_scanned = "clearance_docs/"+$scope.jambRegNo+"/"+$scope.clearanceDets.attestation+"?"+Date();
			}
			
// 			alert($scope.passport_scanned);
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(errorMessage){
		$rootScope.content_loaded = true;
		Data.toast(data);
	});
	
	$scope.printDiv = function(divName){
		//alert();
	
		$scope.showPrint = false;
		printIt(divName);
		
	}
	
		
	function printIt(divName) {
		printContents = document.getElementById(divName).innerHTML;
		//alert(printContents);
		 var originalContents = document.body.innerHTML;
		 document.body.innerHTML = printContents;
	
		 window.print();
		 document.body.innerHTML = originalContents;
	}

});



myApp.controller("authorityToPayCtrl", function($scope, $http, $location, $timeout, $routeParams, $rootScope, $localStorage)
{
	$rootScope.content_loaded = false;
		
	$scope.applicant = $localStorage.bio_data;
	$scope.jambRegNo = $scope.applicant.jambRegNo;
	
	$scope.applicantMode = $scope.applicant.applicantMode;
	$scope.course = $scope.applicant.CourseAdmittedTo;
	
	$scope.applicant_name = $scope.applicant.surname+", "+$scope.applicant.firstname+" "+$scope.applicant.middlename;
	$scope.buttonParts = ["dummy",false,false,false,false,false,false,false, false,false, false];
	$scope.nationality = ["[ Select Nationality ]"];
	$scope.phoneNumbr = /\d{11}/
	
	var today = new Date();
	var dd = today.getDate();
	var mm = today.getMonth()+1; //January is 0!
	
	var yyyy = today.getFullYear();
	if(dd<10){
		dd='0'+dd;
	} 
	if(mm<10){
		mm='0'+mm;
	} 
	$scope.today = dd+'/'+mm+'/'+yyyy;
	
	
	$http.post("backend/authentication.php?action=getClearanceDetails&&jambRegNo="+$scope.jambRegNo)
	.success(function(data){		
		if(data.status == "success"){
			$scope.clearanceDets = data.clearanceDets;
			$scope.auth1 = "images/au1.png";
			$scope.auth2 = "images/a2.png";
			$scope.auth3 = "images/au2.png";			
			
			$scope.at1 = "images/at1.png";
			$scope.at2 = "images/at2.png";
			
			
        	if($scope.clearanceDets.status != "cleared"){
        	    $location.path("applicant/applicant-dashboard/");
        	}
        	
		}
		
		$rootScope.content_loaded = true;
	})
	.error(function(errorMessage){
	    $location.path("applicant/applicant-dashboard/");
		$rootScope.content_loaded = true;
		Data.toast(data);
	});
	
	$scope.printDiv = function(divName){
		//alert();
	
		$scope.showPrint = false;
		printIt(divName);
		
	}
	
		
	function printIt(divName) {
		printContents = document.getElementById(divName).innerHTML;
		//alert(printContents);
		 var originalContents = document.body.innerHTML;
		 document.body.innerHTML = printContents;
	
		 window.print();
		 document.body.innerHTML = originalContents;
	}

});


myApp.controller("alertCtrl", function($scope, items, $modalInstance){
	$scope.message = items;

	$scope.takeAway = function () {
			$modalInstance.dismiss('cancel');
        };
	
	});